##$Id: ibatis.xml.vm,v 1.1 2007/10/19 09:44:20 kameleono Exp $
#parse( "table.include.vm" )
#set ( $tablename = $table.asCoreClass() )
#set ( $classname = "${table.getPackage()}.$tablename" )
#set ( $s = "#" )
#set ( $condition = "1=1" )
#foreach( $pk in $primaryKeys )
	#set ( $condition = "$condition AND $pk.getName()=$s${pk.getVarName()}$s" )
#end
$codewriter.setCurrentFilename("../config/xml", "$tablename.xml")
<?xml version='1.0'?>

<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- WARNING: This is an autogenerated file (JSQL2iBatis - http://sourceforge.net/projects/jsql2ibatis/) -->
<!-- FECHA: $fecha -->

<sqlMap namespace="$tablename">

<!-- 
	<cacheModel id="${tablename}-cache" type="MEMORY">
		<flushInterval hours="24"/>
		<flushOnExecute statement="insert$tablename"/>
		<flushOnExecute statement="update$tablename"/>
		<flushOnExecute statement="delete$tablename"/>
		<property name="reference-type" value="WEAK" />
	</cacheModel>
-->

	<resultMap class="$classname" id="${tablename}-result" >
	#foreach( $campo in $columns )
    	<result property="$campo.getVarName()" column="$campo.getName()" />
  	#end
	</resultMap>

	<select id="getAll" resultClass="$classname" parameterClass="$classname" resultMap="${tablename}-result" >
		<![CDATA[
			select * from $table.getName()
			order by 1
		]]>
	</select>

	<select id="get${tablename}ByPK" resultClass="$classname" parameterClass="$classname" >
		<![CDATA[
			select * from $table.getName()
			where  
			$condition
		]]>
	</select>
	
	<select id="getNextSID" resultClass="java.lang.String" parameterClass="$classname" >
		<![CDATA[
			select max($sid)+1 from $table.getName()
		]]>
	</select>
		
	<update id="update$tablename" parameterClass="$classname" >
		<![CDATA[
			update $table.getName() set
#foreach( $column in $columns )
			#if ( $velocityCount > 1 ), #end$column.getName() = $s$column.getVarName()$s
#end
			where $condition
		]]>
	</update>

	<insert id="insert$tablename" parameterClass="$classname" >
		<![CDATA[
			insert into $table.getName() (
#foreach( $column in $columns )
			#if ( $velocityCount > 1 ), #end$column.getName()
#end
			) values (
#foreach( $column in $columns )
			#if ( $velocityCount > 1 ), #end$s$column.getVarName()$s
#end
			)
		]]>
	</insert>

	<delete id="delete$tablename" parameterClass="$classname" >
		<![CDATA[
			delete from $table.getName()
			where $condition
		]]>
	</delete>

</sqlMap>