// ______________________________________________________
// Generated by sql2java - https://github.com/10km/sql2java-2-6-7 (custom branch) 
// modified by guyadong from
// sql2java original version https://sourceforge.net/projects/sql2java/ 
// jdbc driver used at code generation time: com.mysql.jdbc.Driver
// template: table.manager.java.vm
// ______________________________________________________
package net.gdface.facelog.db;
import java.util.List;
import java.util.LinkedList;
import java.util.Collection;
import java.util.concurrent.Callable;
import net.gdface.facelog.db.exception.ObjectRetrievalException;
/**
 * Interface to handle database calls (save, load, count, etc...) for table.
 * @author guyadong
 */
public interface TableManager<B extends BaseBean<?>> extends Constant {

    public interface Action<B>{
        public abstract class Adapter<B> implements Action<B>{
            @Override
            public B getBean() {return null;}            
        }
        void call(B bean);
        B getBean();
    }
    public abstract static class Adapter<B extends BaseBean<?>> implements TableManager<B>{
        protected abstract Class<B> _beanType();
       /**
         * Insert the B bean into the database.
         * 
         * @param bean the B bean to be saved
         * @return the inserted bean
         */
        //13
        protected abstract B insert(B bean);
        /**
         * Update the B bean record in the database according to the changes.
         *
         * @param bean the B bean to be updated
         * @return the updated bean
         */
        //14
        protected abstract B update(B bean);
        
        public class ListAction implements Action<B> {
            final List<B> list;
            public ListAction() {
                list=new LinkedList<B>();
            }

            public List<B> getList() {
                return list;
            }

            @Override
            public void call(B bean) {
                list.add(bean);
            }

            @Override
            public B getBean() {
                return null;
            }
        }
        @Override
        public int countAll(){
            return this.countWhere("");
        }

        @Override
        public int countUsingTemplate(B bean){
            return this.countUsingTemplate(bean, SEARCH_EXACT);
        }

        @Override
        public int deleteAll(){
            return this.deleteByWhere("");
        }


        @Override
        public B[] loadAll(){
            return this.loadUsingTemplate(null, 1, -1, SEARCH_EXACT);
        }

        @Override
        public int loadAll(Action<B> action){
            return this.loadUsingTemplate(null,null,1,-1, SEARCH_EXACT, action);
        }

        @Override
        public B[] loadAll(int startRow, int numRows){
            return this.loadUsingTemplate(null, startRow, numRows, SEARCH_EXACT);
        }

        @Override
        public int loadAll(int startRow, int numRows, Action<B> action){
            return this.loadUsingTemplate(null, null, startRow, numRows, SEARCH_EXACT, action);
        }

        @Override
        public List<B> loadAllAsList(){
            return this.loadUsingTemplateAsList(null,1, -1, SEARCH_EXACT);
        }

        @Override
        public List<B> loadAllAsList(int startRow, int numRows){
            return this.loadUsingTemplateAsList(null, startRow, numRows, SEARCH_EXACT);
        }

        @Override
        public boolean existsByPrimaryKey(B bean){
            return null!=loadByPrimaryKey(bean);
        }
        @Override
        public B checkDuplicate(B bean){
            throw new UnsupportedOperationException();
        }
        @Override
        public boolean existsPrimaryKey(Object ...keys){
            return null!=loadByPrimaryKey(keys);
        }
        
        @Override
        public B[] loadByWhere(String where){
            return this.loadByWhere(where, (int[])null);
        }

        @Override
        public int loadByWhere(String where, Action<B> action){
            return this.loadByWhere(where, null, action);
        }

        @Override
        public B[] loadByWhere(String where, int[] fieldList){
            return this.loadByWhere(where, fieldList, 1, -1);
        }

        @Override
        public int loadByWhere(String where, int[] fieldList, Action<B> action){
            return this.loadByWhere(where, fieldList, 1, -1, action);
        }

        @SuppressWarnings("unchecked")
        @Override
        public B[] loadByWhere(String where, int[] fieldList, int startRow, int numRows){
            return this.loadByWhereAsList(where, fieldList, startRow, numRows).toArray((B[])java.lang.reflect.Array.newInstance(_beanType(),0));
        }

        @Override
        public int loadByWhere(String where, int[] fieldList, int startRow, int numRows,
                Action<B> action){
            return this.loadByWhereForAction(where, fieldList, startRow, numRows, action);
        }

        @Override
        public List<B> loadByWhereAsList(String where){
            return this.loadByWhereAsList(where, null, 1, -1);
        }

        @Override
        public List<B> loadByWhereAsList(String where, int[] fieldList){
            return this.loadByWhereAsList(where, fieldList, 1, -1);
        }

        @Override
        public List<B> loadByWhereAsList(String where, int[] fieldList, int startRow, int numRows){
            ListAction action = new ListAction();
            loadByWhereForAction(where, fieldList, startRow, numRows, action);              
            return action.getList();
        }
    
        @Override
        public int loadByWhereForAction(String where, int[] fieldList, int startRow, int numRows,Action<B> action){
            String sql=createSelectSql(fieldList, where);
            // System.out.println("loadByWhere: " + sql);
            return this.loadBySqlForAction(sql, null, fieldList, startRow, numRows, action);
        }
    
        @Override
        public B[] loadUsingTemplate(B bean){
            return this.loadUsingTemplate(bean, 1, -1, SEARCH_EXACT);
        }

        @Override
        public int loadUsingTemplate(B bean, Action<B> action){
            return this.loadUsingTemplate(bean, null, 1, -1, SEARCH_EXACT, action);
        }

        @Override
        public B[] loadUsingTemplate(B bean, int startRow, int numRows){
            return this.loadUsingTemplate(bean, startRow, numRows, SEARCH_EXACT);
        }

        @Override
        public int loadUsingTemplate(B bean, int startRow, int numRows,
                Action<B> action){
            return this.loadUsingTemplate(bean, null, startRow, numRows,SEARCH_EXACT, action);
        }

        @SuppressWarnings("unchecked")
        @Override
        public B[] loadUsingTemplate(B bean, int startRow, int numRows, int searchType){
            return this.loadUsingTemplateAsList(bean, startRow, numRows, searchType).toArray((B[])java.lang.reflect.Array.newInstance(_beanType(),0));
        }

        @Override
        public List<B> loadUsingTemplateAsList(B bean){
            return this.loadUsingTemplateAsList(bean, 1, -1, SEARCH_EXACT);
        }

        @Override
        public List<B> loadUsingTemplateAsList(B bean, int startRow, int numRows){
            return this.loadUsingTemplateAsList(bean, startRow, numRows, SEARCH_EXACT);
        }

        @Override
        public List<B> loadUsingTemplateAsList(B bean, int startRow, int numRows, int searchType){
            ListAction action = new ListAction();
            loadUsingTemplate(bean,null,startRow,numRows,searchType, action);
            return action.getList();
        }
        
        @Override
        public B save(B bean){
            if(null == bean)return null;
            if (bean.isNew()) {
                return this.insert(bean);
            } else {
                return this.update(bean);
            }
        }
        
        @Override
        public B[] save(B[] beans){
            if(null != beans){
                for (B bean : beans) 
                {
                    this.save(bean);
                }
            }
            return beans;
        }

        @Override
        public <C extends Collection<B>> C save(C beans){
            if(null != beans){
                for (B bean : beans) 
                {
                    this.save(bean);
                }
            }
            return beans;
        }
        
        @Override
        public <C extends Collection<B>> C saveAsTransaction(final C beans){
            return this.runAsTransaction(new Callable<C>(){
                @Override
                public C call() throws Exception {
                    return save(beans);
                }});
        }

        @Override
        public B[] saveAsTransaction(final B[] beans){
            return this.runAsTransaction(new Callable<B[]>(){
                @Override
                public B[] call() throws Exception {
                    return save(beans);
                }});
        }

        @SuppressWarnings("unchecked")
        @Override
        public B[] loadBySql(String sql, Object[] argList, int[] fieldList){
            return loadBySqlAsList(sql, argList, fieldList).toArray((B[])java.lang.reflect.Array.newInstance(_beanType(),0));
        }

        @Override
        public List<B> loadBySqlAsList(String sql, Object[] argList, int[] fieldList){
            ListAction action = new ListAction();
            loadBySqlForAction(sql,argList,fieldList,1,-1,action);
            return action.getList();
        }
        
        @Override
        public String createSelectSql(int[] fieldList, String where){
            StringBuffer sql = new StringBuffer(128);
            String fullFields = this.getFullFields();
            if(null == fieldList || 0 == fieldList.length) {
                sql.append("SELECT ").append(fullFields);
            } else{
                sql.append("SELECT ");
                String[] names=fullFields.split(",");
                for(int i = 0; i < fieldList.length; ++i){
                    if(i > 0) {
                        sql.append(",");
                    }
                    sql.append(names[fieldList[i]]);
                }      
            }
            sql.append(" FROM " + this.getTableName() + " ");
            if(null!=where)
                sql.append(where);
            return sql.toString();
        }

        @Override
        public int delete(B bean){
            throw new UnsupportedOperationException();
        }
        
        @Override
        public <T extends BaseBean<?>> T getReferencedBean(B bean, int fkIndex){
            throw new UnsupportedOperationException();
        }

        @Override
        public <T extends BaseBean<?>> T setReferencedBean(B bean, T beanToSet, int fkIndex){
            throw new UnsupportedOperationException();
        }

        @Override
        public <T extends BaseBean<?>> T[] getImportedBeans(B bean, int ikIndex){
            throw new UnsupportedOperationException();
        }

        @Override
        public <T extends BaseBean<?>> List<T> getImportedBeansAsList(B bean, int ikIndex){
            throw new UnsupportedOperationException();
        }

        @Override
        public <T extends BaseBean<?>> T[] setImportedBeans(B bean, T[] importedBeans, int ikIndex){
            throw new UnsupportedOperationException();
        }

        @Override
        public <T extends BaseBean<?>, C extends Collection<T>> C setImportedBeans(B bean, C importedBeans,
                int ikIndex){
            throw new UnsupportedOperationException();
        }

        @Override
        public B loadByPrimaryKey(B bean){
            throw new UnsupportedOperationException();
        }
        @Override
        public B loadByPrimaryKeyChecked(B bean) throws ObjectRetrievalException{
            throw new UnsupportedOperationException();
        }
        @Override
        public B loadByPrimaryKey(Object ...keys){
            throw new UnsupportedOperationException();
        }
        @Override
        public B loadByPrimaryKeyChecked(Object ...keys) throws ObjectRetrievalException{
            throw new UnsupportedOperationException();
        }
        @Override
        public int deleteByPrimaryKey(Object ...keys){
            throw new UnsupportedOperationException();
        }
        
        @SuppressWarnings("unchecked")
        @Override
        public B[] loadByIndex(int keyIndex,Object ...keys){
            return this.loadByIndexAsList(keyIndex,keys).toArray((B[])java.lang.reflect.Array.newInstance(_beanType(),0));
        }
        
        @Override
        public List<B> loadByIndexAsList(int keyIndex,Object ...keys){
            throw new UnsupportedOperationException();
        }
        
        @Override
        public int deleteByIndex(int keyIndex,Object ...keys){
            throw new UnsupportedOperationException();
        }
        
        @Override
        public B save(B bean,Object ...args){
            throw new UnsupportedOperationException();
        }
        
        @Override
        public B saveCollection(B bean,Object ...args){
            throw new UnsupportedOperationException();
        }
        
        @Override
        public B saveAsTransaction(final B bean,final Object ...args){
            return this.runAsTransaction(new Callable<B>(){
                @Override
                public B call() throws Exception {
                    return save(bean , args );
                }});
        }
        
        @Override
        public B saveCollectionAsTransaction(final B bean,final Object ...args){
            return this.runAsTransaction(new Callable<B>(){
                @Override
                public B call() throws Exception {
                    return saveCollection(bean , args );
                }});
        }
        
        @Override
        public void runAsTransaction(final Runnable fun){
            this.runAsTransaction(new Callable<Object>() {
                @Override
                public Object call() throws Exception {
                    fun.run();
                    return null;
                }
            });
        }
    }    
    
    public String getFields();
    
    public String[] getPrimarykeyNames();
    
    public String getTableName();
        
    public String getFullFields();
    
    /**
     * return true if @{code column}(case insensitive)is primary key,otherwise return false <br>
     * return false if @{code column} is null or empty 
     * @param column
     * @return
     */
    //43
    public boolean isPrimaryKey(String column);
    
    //_____________________________________________________________________
    //
    // COUNT
    //_____________________________________________________________________
    /**
     * Retrieves the number of rows of the table.
     *
     * @return the number of rows returned
     */
    //24
    public int countAll();
    
    /**
     * count the number of elements of a specific bean
     *
     * @param bean the bean to look for ant count
     * @return the number of rows returned
     */
    //27
    public int countUsingTemplate( B bean);
  
    /**
     * count the number of elements of a specific bean given the search type
     *
     * @param bean the template to look for
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param searchType exact ?  like ? starting like ? ending link ? <br>
     *                {@value Constant#SEARCH_EXACT}   {@link Constant#SEARCH_EXACT} <br>
     *                {@value Constant#SEARCH_LIKE}   {@link Constant#SEARCH_LIKE} <br>
     *                {@value Constant#SEARCH_STARTING_LIKE}   {@link Constant#SEARCH_STARTING_LIKE} <br>
     *                {@value Constant#SEARCH_ENDING_LIKE}   {@link Constant#SEARCH_ENDING_LIKE} <br>  
     * @return the number of rows returned
     */
    //20
    public int countUsingTemplate(B bean, int searchType);

    /**
     * Retrieves the number of rows of the table with a 'where' clause.
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the restriction clause
     * @return the number of rows returned
     */
    //25
    public int countWhere(String where);

    /**
     * Deletes all rows from table.
     * @return the number of deleted rows.
     */
    //10
    public int deleteAll();

    /**
     * Deletes rows from the table using a 'where' clause.
     * It is up to you to pass the 'WHERE' in your where clauses.
     * <br>Attention, if 'WHERE' is omitted it will delete all records.
     *
     * @param where the sql 'where' clause
     * @return the number of deleted rows
     */
    //11
    public int deleteByWhere(String where);

    /**
     * Deletes rows using a template.
     *
     * @param bean the template object(s) to be deleted
     * @return the number of deleted objects
     */
    //21
    public int deleteUsingTemplate(B bean);

    /**
     * Delete row according to its primary keys.
     *
     * @param keys primary keys value<br>
     *      for fl_device table<br>
     *          PK# 1 fl_device.id type Integer<br>
     *      for fl_face table<br>
     *          PK# 1 fl_face.id type Integer<br>
     *      for fl_feature table<br>
     *          PK# 1 fl_feature.md5 type String<br>
     *      for fl_image table<br>
     *          PK# 1 fl_image.md5 type String<br>
     *      for fl_log table<br>
     *          PK# 1 fl_log.id type Integer<br>
     *      for fl_person table<br>
     *          PK# 1 fl_person.id type Integer<br>
     *      for fl_store table<br>
     *          PK# 1 fl_store.md5 type String<br>
     * @return the number of deleted rows
     * @see #delete(B)
     */   
    //2.1
    public int deleteByPrimaryKey(Object ...keys);

    /**
     * Delete row according to primary keys of bean.<br>
     * 
     * @param bean will be deleted ,all keys must not be null
     * @return the number of deleted rows,0 returned if bean is null
     */
    //2.2
    public int delete(B bean);


    //////////////////////////////////////
    // LOAD ALL
    //////////////////////////////////////

    /**
     * Loads all the rows from table.
     *
     * @return an array of B bean
     */
    //5
    public B[] loadAll();

    /**
     * Loads each row from table and dealt with action.
     * @param action  Action object for do something(not null)
     * @return the count dealt by action
     */
    //5-1    
    public int loadAll(Action<B> action);

    /**
     * Loads the given number of rows from table, given the start row.
     *
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @return an array of B bean
     */
    //6
    public B[] loadAll(int startRow, int numRows);

    /**
     *  Loads the given number of rows from table, given the start row and dealt with action.
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param action  Action object for do something(not null)
     * @return the count dealt by action
     */
    //6-1    
    public int loadAll(int startRow, int numRows,Action<B> action);

    /**
     * Loads all the rows from table.
     *
     * @return a list of B bean
     */
    //5-2
    public List<B> loadAllAsList();

    /**
     * Loads the given number of rows from table, given the start row.
     *
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @return a list of B bean
     */
    //6-2
    public List<B> loadAllAsList(int startRow, int numRows);

    /**
     * Loads a B bean from the table using primary key fields of {@code bean}.
     * @param bean the B bean with primary key fields
     * @return a unique B or {@code null} if not found or bean is null
     */
    //1.2
    public B loadByPrimaryKey(B bean);
    
    /**
     * see also {@link loadByPrimaryKey(B)}
     * @return a unique B ,otherwise throw exception
     * @throws ObjectRetrievalException not found
     */
    //1.2.2
    public B loadByPrimaryKeyChecked(B bean) throws ObjectRetrievalException;
    /**
     * Loads a B bean from the table using primary key fields.
     * when you don't know which is primary key of table,you can use the method.
     * @param keys primary keys value:<br> 
     *      for fl_device table<br>
     *          PK# 1 fl_device.id type Integer<br>
     *      for fl_face table<br>
     *          PK# 1 fl_face.id type Integer<br>
     *      for fl_feature table<br>
     *          PK# 1 fl_feature.md5 type String<br>
     *      for fl_image table<br>
     *          PK# 1 fl_image.md5 type String<br>
     *      for fl_log table<br>
     *          PK# 1 fl_log.id type Integer<br>
     *      for fl_person table<br>
     *          PK# 1 fl_person.id type Integer<br>
     *      for fl_store table<br>
     *          PK# 1 fl_store.md5 type String<br>
     * @return a unique B or {@code null} if not found
     */
    //1.3
    public B loadByPrimaryKey(Object ...keys);

    /**
     * see also {@link #loadByPrimaryKey(Object...)}
     * @return a unique B,otherwise throw exception
     * @throws ObjectRetrievalException not found
     */
    //1.3.2
    public B loadByPrimaryKeyChecked(Object ...keys) throws ObjectRetrievalException;
    
    /**
     * Returns true if this table contains row with primary key fields.
     * @param keys primary keys value:<br>
     * @see #loadByPrimaryKey(Object...)
     */
    //1.5
    public boolean existsPrimaryKey(Object ...keys);
    
    /**
     * Returns true if this table contains row specified by primary key fields of B.<br>
     * when you don't know which is primary key of table,you can use the method.
     * @param bean the B bean with primary key fields
     * @return 
     * @see {@link #loadByPrimaryKey(B bean)}
     */
    //1.6
    public boolean existsByPrimaryKey(B bean);
    /**
     * Check duplicated row by primary keys,if row exists throw exception
     * @param bean the B bean with primary key fields
     * @return always bean
     * @see {@link #existsPrimaryKey(B bean)}
     */
    //1.7
    public B checkDuplicate(B bean);
   
    //////////////////////////////////////
    // SQL 'WHERE' METHOD
    //////////////////////////////////////
    /**
     * Retrieves an array of B given a sql 'where' clause.
     *
     * @param where the sql 'where' clause
     * @return 
     */
    //7 
    public B[] loadByWhere(String where);
    
    /**
     * Retrieves each row of B bean given a sql 'where' clause and dealt with action.
     * @param where the sql 'where' clause
     * @param action  Action object for do something(not null)
     * @return the count dealt by action
     */
    //7-1
    public int loadByWhere(String where,Action<B> action);

    /**
     * Retrieves an array of B bean given a sql where clause, and a list of fields.
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the sql 'WHERE' clause
     * @param fieldList array of field's ID
     * @return 
     */
    //8
    public B[] loadByWhere(String where, int[] fieldList);
   
    /**
     * Retrieves each row of B bean given a sql where clause, and a list of fields,
     * and dealt with action.
     * It is up to you to pass the 'WHERE' in your where clauses.
     * @param where the sql 'WHERE' clause
     * @param fieldList array of field's ID
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    //8-1 
    public int loadByWhere(String where, int[] fieldList,Action<B> action);

    /**
     * Retrieves an array of B bean given a sql where clause and a list of fields, and startRow and numRows.
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the sql 'where' clause
     * @param fieldList table of the field's associated constants
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @return 
     */
    //9
    public B[] loadByWhere(String where, int[] fieldList, int startRow, int numRows);

    /**
     * Retrieves each row of B bean given a sql where clause and a list of fields, and startRow and numRows,
     * and dealt wity action.
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the sql 'where' clause
     * @param fieldList table of the field's associated constants
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    //9-1    
    public int loadByWhere(String where, int[] fieldList, int startRow, int numRows,Action<B> action);
    /**
     * Retrieves a list of B bean given a sql 'where' clause.
     *
     * @param where the sql 'where' clause
     * @return
     */
    //7
    public List<B> loadByWhereAsList(String where);

    /**
     * Retrieves a list of B bean given a sql where clause, and a list of fields.
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the sql 'WHERE' clause
     * @param fieldList array of field's ID
     * @return
     */
    //8
    public List<B> loadByWhereAsList(String where, int[] fieldList);
    
    /**
     * Retrieves a list of B bean given a sql where clause and a list of fields, and startRow and numRows.
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the sql 'where' clause
     * @param fieldList table of the field's associated constants
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @return
     */
    //9-2
    public List<B> loadByWhereAsList(String where, int[] fieldList, int startRow, int numRows);

    /**
     * Retrieves each row of B bean given a sql where clause and a list of fields, and startRow and numRows,
     * and dealt wity action
     * It is up to you to pass the 'WHERE' in your where clauses.
     *
     * @param where the sql 'where' clause
     * @param fieldList table of the field's associated constants
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    //9-3
    public int loadByWhereForAction(String where, int[] fieldList, int startRow, int numRows,Action<B> action);

    //_____________________________________________________________________
    //
    // USING TEMPLATE
    //_____________________________________________________________________
    /**
     * Loads a unique B bean from a template one giving a c
     *
     * @param bean the B bean to look for
     * @return the bean matching the template,or {@code null} if not found or null input argument
     * @throws ObjectRetrievalException more than one row
     */
    //18   
    public B loadUniqueUsingTemplate(B bean);

    /**
     * Loads a unique B bean from a template one giving a c
     *
     * @param bean the B bean to look for
     * @return the bean matching the template
     * @throws ObjectRetrievalException not found or more than one row
     */
    //18-1
    public B loadUniqueUsingTemplateChecked(B bean) throws ObjectRetrievalException;

    /**
     * Loads an array of B from a template one.
     *
     * @param bean the B bean template to look for
     * @return all the B beans matching the template
     */
    //19
    public B[] loadUsingTemplate(B bean);
    
    /**
     * Loads each row from a template one and dealt with action.
     *
     * @param bean the B bean template to look for
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    //19-1
    public int loadUsingTemplate(B bean,Action<B> action);

    /**
     * Loads an array of B bean from a template one, given the start row and number of rows.
     *
     * @param bean the B bean template to look for
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @return all the B matching the template
     */
    //20
    public B[] loadUsingTemplate(B bean, int startRow, int numRows);
    
    /**
     * Loads each row from a template one, given the start row and number of rows and dealt with action.
     *
     * @param bean the B bean template to look for
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    //20-1
    public int loadUsingTemplate(B bean, int startRow, int numRows,Action<B> action);

    /**
     * Loads each row from a template one, given the start row and number of rows and dealt with action.
     *
     * @param bean the B template to look for
     * @param fieldList table of the field's associated constants
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param searchType exact ?  like ? starting like ? ending link ? <br>
     *                {@value Constant#SEARCH_EXACT}   {@link Constant#SEARCH_EXACT} <br>
     *                {@value Constant#SEARCH_LIKE}   {@link Constant#SEARCH_LIKE} <br>
     *                {@value Constant#SEARCH_STARTING_LIKE}   {@link Constant#SEARCH_STARTING_LIKE} <br>
     *                {@value Constant#SEARCH_ENDING_LIKE}   {@link Constant#SEARCH_ENDING_LIKE} <br>  
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    //20-5
    public int loadUsingTemplate(B bean, int[] fieldList, int startRow, int numRows,int searchType, Action<B> action);
    /**
     * Loads a list of B bean from a template one, given the start row and number of rows.
     *
     * @param bean the B bean template to look for
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param searchType exact ?  like ? starting like ? ending link ? <br>
     *                {@value Constant#SEARCH_EXACT}   {@link Constant#SEARCH_EXACT} <br>
     *                {@value Constant#SEARCH_LIKE}   {@link Constant#SEARCH_LIKE} <br>
     *                {@value Constant#SEARCH_STARTING_LIKE}   {@link Constant#SEARCH_STARTING_LIKE} <br>
     *                {@value Constant#SEARCH_ENDING_LIKE}   {@link Constant#SEARCH_ENDING_LIKE} <br>  
     * @return all the B bean matching the template
     */
    //20-4
    public B[] loadUsingTemplate(B bean, int startRow, int numRows, int searchType);

    /**
     * Loads a list of B bean from a template one.
     *
     * @param bean the B bean template to look for
     * @return all the B beans matching the template
     */
    //19-2
    public List<B> loadUsingTemplateAsList(B bean);

    /**
     * Loads a list of B bean from a template one, given the start row and number of rows.
     *
     * @param bean the B bean template to look for
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @return all the B bean matching the template
     */
    //20-2
    public List<B> loadUsingTemplateAsList(B bean, int startRow, int numRows);

    /**
     * Loads an array of B bean from a template one, given the start row and number of rows.
     *
     * @param bean the B bean template to look for
     * @param startRow the start row to be used (first row = 1, last row=-1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param searchType exact ?  like ? starting like ? ending link? <br>
     *                {@value Constant#SEARCH_EXACT}   {@link Constant#SEARCH_EXACT} <br>
     *                {@value Constant#SEARCH_LIKE}   {@link Constant#SEARCH_LIKE} <br>
     *                {@value Constant#SEARCH_STARTING_LIKE}   {@link Constant#SEARCH_STARTING_LIKE} <br>
     *                {@value Constant#SEARCH_ENDING_LIKE}   {@link Constant#SEARCH_ENDING_LIKE} <br>  
     * @return all the B beans matching the template
     */
    //20-3
    public List<B> loadUsingTemplateAsList(B bean, int startRow, int numRows, int searchType);

    //_____________________________________________________________________
    //
    // USING INDICES
    //_____________________________________________________________________    
    /**
     * Retrieves a array of B bean using the index specified by keyIndex.
     * @param keyIndex valid values:see also {@link #loadByIndexAsList(int,Object ...)}
     * @param keys key values of index
     * @return
     * @see #loadByIndexAsList(int ,Object ...)
     */
    public B[] loadByIndex(int keyIndex,Object ...keys);
    
    /**
     * Retrieves a list of B bean using the index specified by keyIndex.
     * @param keyIndex valid values: <br>
     *        for fl_device table<br>
     *        {@link Constant#FL_DEVICE_INDEX_MAC},{@link Constant#FL_DEVICE_INDEX_SERIAL_NO},{@link Constant#FL_DEVICE_INDEX_GROUP_ID}<br>     
     *        for fl_face table<br>
     *        {@link Constant#FL_FACE_INDEX_FEATURE_MD5},{@link Constant#FL_FACE_INDEX_IMAGE_MD5}<br>     
     *        for fl_feature table<br>
     *        {@link Constant#FL_FEATURE_INDEX_PERSON_ID}<br>     
     *        for fl_image table<br>
     *        {@link Constant#FL_IMAGE_INDEX_DEVICE_ID}<br>     
     *        for fl_log table<br>
     *        {@link Constant#FL_LOG_INDEX_COMPARE_FACE},{@link Constant#FL_LOG_INDEX_DEVICE_ID},{@link Constant#FL_LOG_INDEX_PERSON_ID},{@link Constant#FL_LOG_INDEX_VERIFY_FEATURE}<br>     
     *        for fl_person table<br>
     *        {@link Constant#FL_PERSON_INDEX_IMAGE_MD5},{@link Constant#FL_PERSON_INDEX_PAPERS_NUM},{@link Constant#FL_PERSON_INDEX_EXPIRY_DATE},{@link Constant#FL_PERSON_INDEX_GROUP_ID}<br>     
     * @param keys key values of index
     * @return a list of B bean
     */
    public java.util.List<B> loadByIndexAsList(int keyIndex,Object ...keys);
    
    /**
     * Deletes rows using key.
     * @param keyIndex valid values: see also {@link #loadByIndexAsList(int,Object ...)}
     * @param keys key values of index
     * @return the number of deleted objects
     */
    public int deleteByIndex(int keyIndex,Object ...keys);
    //_____________________________________________________________________
    //
    // LISTENER
    //_____________________________________________________________________

    /**
     * Registers a unique {@link TableListener} listener.<br>
     * do nothing if {@code TableListener} instance exists
     */
    //35
    public TableListener<B> registerListener(TableListener<B> listener);

    /**
     * remove listener.
     */
    //36
    public void unregisterListener(TableListener<B> listener);

    /**
     * @see {@link TableListener.Event#fire(TableListener.ListenerContainer, Object)}
     */
    //37
    public void fire(TableListener.Event event, B bean) ;
    
    /**
     * @see #fire(TableListener.Event, B)
     * @throws IllegalArgumentException invalid event id
     */
    //37-1
    public void fire(int event, B bean) ;
    //_____________________________________________________________________
    //
    // SAVE
    //_____________________________________________________________________
    /**
     * Saves the B bean into the database.
     *
     * @param bean the B bean to be saved
     * @return the inserted or updated bean,or null if bean is null
     */
    //12
    public B save(B bean);

    /**
     * Saves an array of B bean into the database.
     *
     * @param beans the array of  B bean to be saved
     * @return alwarys beans saved
     */
    //15
    public B[] save(B[] beans);
    
    /**
     * Saves a collection of B bean into the database.
     *
     * @param beans the B bean table to be saved
     * @return alwarys beans saved
     */
    //15-2
    public <C extends Collection<B>> C saveAsTransaction(C beans);
    
    /**
     * Saves an array of B bean into the database as transaction.
     *
     * @param beans the B bean table to be saved
     * @return alwarys beans saved
     * @see #save(B[])
     */
    //15-3
    public B[] saveAsTransaction(B[] beans);

    /**
     * Saves a collection of B bean into the database as transaction.
     *
     * @param beans the B bean table to be saved
     * @return alwarys beans saved
     */
    //15-4
    public <C extends Collection<B>> C save(C beans);

    /**
     * Save the B bean and referenced beans and imported beans (array) into the database.
     *
     * @param bean the B bean to be saved
     * @param args referenced beans or imported beans,for each table,each argument's type is different:<br>
            for fl_device table:<br>
                {@code  ImageBean[] LogBean[]}<br>
            for fl_face table:<br>
                {@code  FeatureBean ImageBean LogBean[]}<br>
            for fl_feature table:<br>
                {@code  PersonBean FaceBean[] LogBean[]}<br>
            for fl_image table:<br>
                {@code  DeviceBean FaceBean[] PersonBean[]}<br>
            for fl_log table:<br>
                {@code  DeviceBean FaceBean FeatureBean PersonBean}<br>
            for fl_person table:<br>
                {@code  ImageBean FeatureBean[] LogBean[]}<br>
     * @return the inserted or updated B bean
      */
    //3.9 SYNC SAVE 
    public B save(B bean,Object ...args);
    
    /**
     * Save the B bean and referenced beans and imported beans (collection) into the database.
     *
     * @param bean the B bean to be saved
     * @param args referenced beans or imported beans,for each table,each argument's type is different:<br>
            for fl_device table:<br>
                {@code  Collection<ImageBean> Collection<LogBean>}<br>
            for fl_face table:<br>
                {@code  FeatureBean ImageBean Collection<LogBean>}<br>
            for fl_feature table:<br>
                {@code  PersonBean Collection<FaceBean> Collection<LogBean>}<br>
            for fl_image table:<br>
                {@code  DeviceBean Collection<FaceBean> Collection<PersonBean>}<br>
            for fl_log table:<br>
                {@code  DeviceBean FaceBean FeatureBean PersonBean}<br>
            for fl_person table:<br>
                {@code  ImageBean Collection<FeatureBean> Collection<LogBean>}<br>
     * @return the inserted or updated B bean
     */
    //3.10 SYNC SAVE 
    public B saveCollection(B bean,Object ...args);
    
    /**
     *  Transaction version for sync save
     * @see #save(B ,Object ...)
     * @param bean the B bean to be saved
     * @param args referenced beans or imported beans<br>
     * @return the inserted or updated B bean
     */
    //3.11 SYNC SAVE 
    public B saveAsTransaction(B bean,Object ...args);
    
    /**
     *  Transaction version for sync save
     * @see #saveCollection(B ,Object ...)
     * @param bean the B bean to be saved
     * @param args referenced beans or imported beans<br>
     * @return the inserted or updated B bean
     */
    //3.12 SYNC SAVE 
    public B saveCollectionAsTransaction(B bean,Object ...args);
        
    /**
     * Load all the elements using a SQL statement specifying a list of fields to be retrieved.
     * @param sql the SQL statement for retrieving
     * @param argList the arguments to use fill given prepared statement,may be null
     * @param fieldList table of the field's associated constants
     * @return an array of B bean
     */
    public B[] loadBySql(String sql, Object[] argList, int[] fieldList);
    
    /**
     * Load all elements using a SQL statement specifying a list of fields to be retrieved.
     * @param sql the SQL statement for retrieving
     * @param argList the arguments to use fill given prepared statement,may be null
     * @param fieldList table of the field's associated constants
     * @return an list of B bean
     */
    public List<B> loadBySqlAsList(String sql, Object[] argList, int[] fieldList);
    
    /**
     * Load each the elements using a SQL statement specifying a list of fields to be retrieved and dealt by action.
     * @param sql the SQL statement for retrieving
     * @param argList the arguments to use fill given prepared statement,may be null
     * @param fieldList table of the field's associated constants
     * @param startRow the start row to be used (first row = 1, last row = -1)
     * @param numRows the number of rows to be retrieved (all rows = a negative number)
     * @param action Action object for do something(not null)
     * @return the count dealt by action
     */
    public int loadBySqlForAction(String sql, Object[] argList, int[] fieldList,int startRow, int numRows,Action<B> action);
    /**
     * Run {@code Callable<T>} as a transaction.<br>
     * all exceptions but {@code SQLException} threw by {@code Callable<T>} is warpped into {@code RuntimeException}<br>
     * throw {@code NullPointerException} if {@code fun} be {@code null}<br>
     * @param <T>  type of return result
     * @param fun
     * @return
     */
    public<T> T runAsTransaction(Callable<T> fun);

    /**
     * Run {@code Runnable} as a transaction.no return
     * @param fun
     * @
     * @see #runAsTransaction(Runnable)
     */
    public void runAsTransaction(Runnable fun);
    
    /**
     * Retrieves the T object referenced by fkName.<br>
     * @param <T>
     * <ul>
     *     <li> for fl_face:
     *     <li> {@link Constant#FL_FACE_FK_FEATURE_MD5} -> {@link FeatureBean}</li>
     *     <li> {@link Constant#FL_FACE_FK_IMAGE_MD5} -> {@link ImageBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_feature:
     *     <li> {@link Constant#FL_FEATURE_FK_PERSON_ID} -> {@link PersonBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_image:
     *     <li> {@link Constant#FL_IMAGE_FK_DEVICE_ID} -> {@link DeviceBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_log:
     *     <li> {@link Constant#FL_LOG_FK_DEVICE_ID} -> {@link DeviceBean}</li>
     *     <li> {@link Constant#FL_LOG_FK_COMPARE_FACE} -> {@link FaceBean}</li>
     *     <li> {@link Constant#FL_LOG_FK_VERIFY_FEATURE} -> {@link FeatureBean}</li>
     *     <li> {@link Constant#FL_LOG_FK_PERSON_ID} -> {@link PersonBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_person:
     *     <li> {@link Constant#FL_PERSON_FK_IMAGE_MD5} -> {@link ImageBean}</li>
     * </ul>
     * @param bean the B object to use
     * @param fkIndex foreign key name.<br>
     *        for for fl_face table:<br>
     *        {@link Constant#FL_FACE_FK_FEATURE_MD5},{@link Constant#FL_FACE_FK_IMAGE_MD5}<br>
     *        for for fl_feature table:<br>
     *        {@link Constant#FL_FEATURE_FK_PERSON_ID}<br>
     *        for for fl_image table:<br>
     *        {@link Constant#FL_IMAGE_FK_DEVICE_ID}<br>
     *        for for fl_log table:<br>
     *        {@link Constant#FL_LOG_FK_DEVICE_ID},{@link Constant#FL_LOG_FK_COMPARE_FACE},{@link Constant#FL_LOG_FK_VERIFY_FEATURE},{@link Constant#FL_LOG_FK_PERSON_ID}<br>
     *        for for fl_person table:<br>
     *        {@link Constant#FL_PERSON_FK_IMAGE_MD5}<br>
     * @return the associated <T> bean or {@code null} if {@code bean}  is {@code null}
     */
    public <T extends BaseBean<?>> T getReferencedBean(B bean,int fkIndex);
    
    /**
     * Associates the B object to the T object by fkName field.<br>
     * @param <T> see also {@link #getReferencedBean(B, int)}
     * @param bean the B object to use
     * @param beanToSet the T object to associate to the B bean
     * @param fkIndex see also {@link #getReferencedBean(B, int)}
     * @return always beanToSet saved
     */
    public <T extends BaseBean<?>> T setReferencedBean(B bean,T beanToSet,int fkIndex);
    
    /**
     * Retrieves imported T objects by fkIndex.<br>
     * @param <T>
     * <ul>
     *     <li> for fl_device table:
     *     <li> {@link Constant#FL_DEVICE_IK_FL_IMAGE_DEVICE_ID} -> {@link ImageBean}</li>
     *     <li> {@link Constant#FL_DEVICE_IK_FL_LOG_DEVICE_ID} -> {@link ImageBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_face table:
     *     <li> {@link Constant#FL_FACE_IK_FL_LOG_COMPARE_FACE} -> {@link ImageBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_feature table:
     *     <li> {@link Constant#FL_FEATURE_IK_FL_FACE_FEATURE_MD5} -> {@link ImageBean}</li>
     *     <li> {@link Constant#FL_FEATURE_IK_FL_LOG_VERIFY_FEATURE} -> {@link ImageBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_image table:
     *     <li> {@link Constant#FL_IMAGE_IK_FL_FACE_IMAGE_MD5} -> {@link ImageBean}</li>
     *     <li> {@link Constant#FL_IMAGE_IK_FL_PERSON_IMAGE_MD5} -> {@link ImageBean}</li>
     * </ul>
     * <ul>
     *     <li> for fl_person table:
     *     <li> {@link Constant#FL_PERSON_IK_FL_FEATURE_PERSON_ID} -> {@link ImageBean}</li>
     *     <li> {@link Constant#FL_PERSON_IK_FL_LOG_PERSON_ID} -> {@link ImageBean}</li>
     * </ul>
     * @param bean the B object to use
     * @param ikIndex foreign key name.<br>
     *        for fl_device table:<br>
     *        {@link Constant#FL_IMAGE_FK_DEVICE_ID},{@link Constant#FL_LOG_FK_DEVICE_ID}<br>
     *        for fl_face table:<br>
     *        {@link Constant#FL_LOG_FK_COMPARE_FACE}<br>
     *        for fl_feature table:<br>
     *        {@link Constant#FL_FACE_FK_FEATURE_MD5},{@link Constant#FL_LOG_FK_VERIFY_FEATURE}<br>
     *        for fl_image table:<br>
     *        {@link Constant#FL_FACE_FK_IMAGE_MD5},{@link Constant#FL_PERSON_FK_IMAGE_MD5}<br>
     *        for fl_person table:<br>
     *        {@link Constant#FL_FEATURE_FK_PERSON_ID},{@link Constant#FL_LOG_FK_PERSON_ID}<br>
     * @return the associated T beans or {@code null} if {@code bean} is {@code null}
     */
    public <T extends BaseBean<?>> T[] getImportedBeans(B bean,int ikIndex);
    
    /**
     * Retrieves imported T objects by ikIndex.<br>
     * @param <T> see also {@link #getImportedBeans(B, int)}
     * @param bean the B object to use
     * @param ikIndex foreign key name.see also {@link #getImportedBeans(B, int)}
     * @return the associated T beans or {@code null} if {@code bean} is {@code null}
     */
    public <T extends BaseBean<?>> List<T> getImportedBeansAsList(B bean,int ikIndex);
    
    /**
     * Set the importedBeans associates to the bean by fkIndex<br>
     * 
     * @param <T> see also {@link #getImportedBeans(B, int)}
     * @param bean the bean object to use
     * @param importedBeans the T object to associate to bean
     * @param fkIndex foreign key name.see also {@link #getImportedBeans(B, int)}
     * @return importedBeans always
     */
    public <T extends BaseBean<?>> T[] setImportedBeans(B bean,T[] importedBeans,int ikIndex);
    
    /**
     * Set the importedBeans associates to the bean by fkIndex<br>
     * 
     * @param <T> see also {@link #getImportedBeans(B, int)}
     * @param bean the bean object to use
     * @param importedBeans the T object to associate to bean
     * @param fkIndex foreign key name. see also {@link #getImportedBeans(B, int)}
     * @return importedBeans always
     */
    public <T extends BaseBean<?>,C extends Collection<T>> C setImportedBeans(B bean,C importedBeans,int ikIndex);
    
    public String createSelectSql(int[] fieldList,String where);
}
