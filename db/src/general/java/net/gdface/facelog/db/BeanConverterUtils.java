// ______________________________________________________
// Generated by sql2java - https://github.com/10km/sql2java-2-6-7 (custom branch) 
// modified by guyadong from
// sql2java original version https://sourceforge.net/projects/sql2java/ 
// JDBC driver used at code generation time: com.mysql.jdbc.Driver
// template: bean.converter.utils.java.vm
// ______________________________________________________
package net.gdface.facelog.db;
import java.io.PrintWriter;
import java.io.StringWriter;
import java.lang.reflect.Method;
import java.nio.ByteBuffer;
import java.util.Map;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Hashtable;
import java.util.List;

import net.gdface.facelog.db.IBeanConverter;

import net.gdface.facelog.db.DeviceBean;
import net.gdface.facelog.db.DeviceGroupBean;
import net.gdface.facelog.db.FaceBean;
import net.gdface.facelog.db.FeatureBean;
import net.gdface.facelog.db.ImageBean;
import net.gdface.facelog.db.LogBean;
import net.gdface.facelog.db.PermitBean;
import net.gdface.facelog.db.PersonBean;
import net.gdface.facelog.db.PersonGroupBean;
import net.gdface.facelog.db.StoreBean;
import net.gdface.facelog.db.LogLightBean;

/**
 * generic type converter classes of {@link IBeanConverter} implementation for fl_device,fl_device_group,fl_face,fl_feature,fl_image,fl_log,fl_permit,fl_person,fl_person_group,fl_store,fl_log_light<br>
 * @author guyadong
 *
 */
public class BeanConverterUtils implements Constant {
    public static final String GET_INITIALIZED = "getInitialized";
    public static final String SET_INITIALIZED = "setInitialized";
    public static final String GET_MODIFIED = "getModified";
    public static final String SET_MODIFIED = "setModified";
    public static final String SET_NEW = "setNew";
    public static final String IS_NEW = "isNew";
    private static class NullCastPrimitiveException extends ClassCastException {
        private static final long serialVersionUID = 1L;
        NullCastPrimitiveException(String message) {
            super(message);
        }
    }
    private BeanConverterUtils(){}
    /**
     * 返回buffer中所有字节(position~limit),不改变buffer状态
     * @param buffer
     * @return
     */
    private static final byte[] getBytesInBuffer(ByteBuffer buffer){
        int pos = buffer.position();
        try{
            byte[] bytes = new byte[buffer.remaining()];
            buffer.get(bytes);
            return bytes;
        }finally{
            buffer.position(pos);
        }
    }
    private static final List<Long> toList(long[] array) {
        ArrayList<Long> result = new ArrayList<Long>(array.length);
        for (int i = 0; i < array.length; i++) {
            result.add(new Long(array[i]));
        }
        return result;
    }
    private static final long[] toPrimitive(List<Long> list) {        
        long[] dst = new long[list.size()];
        Long element;
        for (int i = 0; i < dst.length; i++) {
            if(null == (element = list.get(i)))
                throw new IllegalArgumentException("can't cast List<Long> to long[] because of null element");
            dst[i] = element.longValue();
        }
        return dst;
    }
    /**
     * {@code source}转为{@code type}指定的类型
     * @param type destination type
     * @param source  source object
     * @return
     */
    @SuppressWarnings({ "unchecked" })
    private static final <T> T cast(Class<T> type,Object source){
        try{
            if(null ==source && type.isPrimitive())
                throw new NullCastPrimitiveException(String.format("can't convert null to primitive type %s",type.getSimpleName()));
            return (T) source;
        }catch(ClassCastException cce){
            // long[] -> List  
            if(List.class.isAssignableFrom(type) && (source instanceof long[])){
                return (T) toList((long[]) source);
            }
            // List -> long[]   
            if(long[].class == type && (source instanceof List)){
                return (T) toPrimitive( (List<Long>) source);
            }
            // Long -> Date
            if(java.util.Date.class.isAssignableFrom(type) && (source instanceof Long)){
                try {
                    // call constructor,such as  java.util.Date#Date(long), java.sql.Time.Time(long)
                    return type.getConstructor(long.class).newInstance(source);
                } catch (Exception e) {
                    StringWriter writer = new StringWriter();
                    e.printStackTrace(new PrintWriter(writer));
                    throw new ClassCastException(writer.toString());
                }
            }
            // Date -> Long,long
            if( (long.class == type || Long.class == type) && source instanceof java.util.Date){
                    Long time = ((java.util.Date)source).getTime();
                    return (T)time;
            }
            // byte[] -> ByteBuffer
            if(ByteBuffer.class == type && source instanceof byte[]){
                return (T) ByteBuffer.wrap((byte[]) source);
            }
            // ByteBuffer -> byte[]
            if(byte[].class == type && source instanceof ByteBuffer){
                return (T) getBytesInBuffer((ByteBuffer) source);
            }
            throw cce;
        }
    }
    private static final boolean bitCheck(int index,long...bits){
        return 0 != (bits[index>>6]&(1L<<(index&0x3f)));
    }
    private static final long[] bitOR(int index,long... bits){
         bits[index>>6] |= (1L<<(index&0x3f));
         return bits;
    }
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link DeviceBean} and R_DEVICE <br>
     * @author guyadong
     * @param <R_DEVICE> right type
     *
     */
    public static class DeviceBeanConverter<R_DEVICE> extends IBeanConverter.AbstractHandle<DeviceBean,R_DEVICE>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new DeviceBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_DEVICE,<br>
         *                   if null or empty, use default string:{@link Constant#FL_DEVICE_JAVA_FIELDS}
         */
        public DeviceBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #DeviceBeanConverter(String) */
        public DeviceBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #DeviceBeanConverter(String)}
         */
        public DeviceBeanConverter (Class<DeviceBean> leftClass, Class<R_DEVICE> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #DeviceBeanConverter(Class,Class,String) */
        public DeviceBeanConverter (Class<DeviceBean> leftClass, Class<R_DEVICE> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_DEVICE_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setGroupId");
            getSetterNoThrow("setGroupId",Integer.class,int.class);                    
            getGetter("setName");
            getSetterNoThrow("setName",String.class); 
            getGetter("setVersion");
            getSetterNoThrow("setVersion",String.class); 
            getGetter("setSerialNo");
            getSetterNoThrow("setSerialNo",String.class); 
            getGetter("setMac");
            getSetterNoThrow("setMac",String.class); 
            getGetter("setCreateTime");
            getSetterNoThrow("setCreateTime",java.util.Date.class,Long.class,long.class);  
            getGetter("setUpdateTime");
            getSetterNoThrow("setUpdateTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(DeviceBean left, R_DEVICE right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_DEVICE_ID_ID_MASK;

                }
                if( bitCheck("groupId",initialized) && (null != (getterMethod = methods.get("getGroupId")))){
                    left.setGroupId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("groupId",modified))
                        selfModified |= FL_DEVICE_ID_GROUP_ID_MASK;

                }
                if( bitCheck("name",initialized) && (null != (getterMethod = methods.get("getName")))){
                    left.setName(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("name",modified))
                        selfModified |= FL_DEVICE_ID_NAME_MASK;

                }
                if( bitCheck("version",initialized) && (null != (getterMethod = methods.get("getVersion")))){
                    left.setVersion(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("version",modified))
                        selfModified |= FL_DEVICE_ID_VERSION_MASK;

                }
                if( bitCheck("serialNo",initialized) && (null != (getterMethod = methods.get("getSerialNo")))){
                    left.setSerialNo(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("serialNo",modified))
                        selfModified |= FL_DEVICE_ID_SERIAL_NO_MASK;

                }
                if( bitCheck("mac",initialized) && (null != (getterMethod = methods.get("getMac")))){
                    left.setMac(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("mac",modified))
                        selfModified |= FL_DEVICE_ID_MAC_MASK;

                }
                if( bitCheck("createTime",initialized) && (null != (getterMethod = methods.get("getCreateTime")))){
                    left.setCreateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("createTime",modified))
                        selfModified |= FL_DEVICE_ID_CREATE_TIME_MASK;

                }
                if( bitCheck("updateTime",initialized) && (null != (getterMethod = methods.get("getUpdateTime")))){
                    left.setUpdateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("updateTime",modified))
                        selfModified |= FL_DEVICE_ID_UPDATE_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(DeviceBean left, R_DEVICE right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setGroupId")) && left.checkGroupIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setGroupId"),left.getGroupId()));
                        bitOR("groupId",initialized);
                        if(left.checkGroupIdModified())
                            bitOR("groupId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setName")) && left.checkNameInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setName"),left.getName()));
                        bitOR("name",initialized);
                        if(left.checkNameModified())
                            bitOR("name",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setVersion")) && left.checkVersionInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setVersion"),left.getVersion()));
                        bitOR("version",initialized);
                        if(left.checkVersionModified())
                            bitOR("version",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setSerialNo")) && left.checkSerialNoInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setSerialNo"),left.getSerialNo()));
                        bitOR("serialNo",initialized);
                        if(left.checkSerialNoModified())
                            bitOR("serialNo",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setMac")) && left.checkMacInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setMac"),left.getMac()));
                        bitOR("mac",initialized);
                        if(left.checkMacModified())
                            bitOR("mac",modified);
                    }catch(NullCastPrimitiveException e){}
                }
// IGNORE field fl_device.create_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setCreateTime")) && left.checkCreateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setCreateTime"),left.getCreateTime()));
                        bitOR("createTime",initialized);
                        if(left.checkCreateTimeModified())
                            bitOR("createTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
// IGNORE field fl_device.update_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setUpdateTime")) && left.checkUpdateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setUpdateTime"),left.getUpdateTime()));
                        bitOR("updateTime",initialized);
                        if(left.checkUpdateTimeModified())
                            bitOR("updateTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link DeviceGroupBean} and R_DEVICEGROUP <br>
     * @author guyadong
     * @param <R_DEVICEGROUP> right type
     *
     */
    public static class DeviceGroupBeanConverter<R_DEVICEGROUP> extends IBeanConverter.AbstractHandle<DeviceGroupBean,R_DEVICEGROUP>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new DeviceGroupBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_DEVICEGROUP,<br>
         *                   if null or empty, use default string:{@link Constant#FL_DEVICE_GROUP_JAVA_FIELDS}
         */
        public DeviceGroupBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #DeviceGroupBeanConverter(String) */
        public DeviceGroupBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #DeviceGroupBeanConverter(String)}
         */
        public DeviceGroupBeanConverter (Class<DeviceGroupBean> leftClass, Class<R_DEVICEGROUP> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #DeviceGroupBeanConverter(Class,Class,String) */
        public DeviceGroupBeanConverter (Class<DeviceGroupBean> leftClass, Class<R_DEVICEGROUP> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_DEVICE_GROUP_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setName");
            getSetterNoThrow("setName",String.class); 
            getGetter("setLeaf");
            getSetterNoThrow("setLeaf",Integer.class,int.class);                    
            getGetter("setParent");
            getSetterNoThrow("setParent",Integer.class,int.class);                    
        }
        @Override
        protected void _fromRight(DeviceGroupBean left, R_DEVICEGROUP right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_DEVICE_GROUP_ID_ID_MASK;

                }
                if( bitCheck("name",initialized) && (null != (getterMethod = methods.get("getName")))){
                    left.setName(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("name",modified))
                        selfModified |= FL_DEVICE_GROUP_ID_NAME_MASK;

                }
                if( bitCheck("leaf",initialized) && (null != (getterMethod = methods.get("getLeaf")))){
                    left.setLeaf(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("leaf",modified))
                        selfModified |= FL_DEVICE_GROUP_ID_LEAF_MASK;

                }
                if( bitCheck("parent",initialized) && (null != (getterMethod = methods.get("getParent")))){
                    left.setParent(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("parent",modified))
                        selfModified |= FL_DEVICE_GROUP_ID_PARENT_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(DeviceGroupBean left, R_DEVICEGROUP right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setName")) && left.checkNameInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setName"),left.getName()));
                        bitOR("name",initialized);
                        if(left.checkNameModified())
                            bitOR("name",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setLeaf")) && left.checkLeafInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setLeaf"),left.getLeaf()));
                        bitOR("leaf",initialized);
                        if(left.checkLeafModified())
                            bitOR("leaf",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setParent")) && left.checkParentInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setParent"),left.getParent()));
                        bitOR("parent",initialized);
                        if(left.checkParentModified())
                            bitOR("parent",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link FaceBean} and R_FACE <br>
     * @author guyadong
     * @param <R_FACE> right type
     *
     */
    public static class FaceBeanConverter<R_FACE> extends IBeanConverter.AbstractHandle<FaceBean,R_FACE>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new FaceBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_FACE,<br>
         *                   if null or empty, use default string:{@link Constant#FL_FACE_JAVA_FIELDS}
         */
        public FaceBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #FaceBeanConverter(String) */
        public FaceBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #FaceBeanConverter(String)}
         */
        public FaceBeanConverter (Class<FaceBean> leftClass, Class<R_FACE> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #FaceBeanConverter(Class,Class,String) */
        public FaceBeanConverter (Class<FaceBean> leftClass, Class<R_FACE> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_FACE_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setImageMd5");
            getSetterNoThrow("setImageMd5",String.class); 
            getGetter("setFaceLeft");
            getSetterNoThrow("setFaceLeft",Integer.class,int.class);                    
            getGetter("setFaceTop");
            getSetterNoThrow("setFaceTop",Integer.class,int.class);                    
            getGetter("setFaceWidth");
            getSetterNoThrow("setFaceWidth",Integer.class,int.class);                    
            getGetter("setFaceHeight");
            getSetterNoThrow("setFaceHeight",Integer.class,int.class);                    
            getGetter("setEyeLeftx");
            getSetterNoThrow("setEyeLeftx",Integer.class,int.class);                    
            getGetter("setEyeLefty");
            getSetterNoThrow("setEyeLefty",Integer.class,int.class);                    
            getGetter("setEyeRightx");
            getSetterNoThrow("setEyeRightx",Integer.class,int.class);                    
            getGetter("setEyeRighty");
            getSetterNoThrow("setEyeRighty",Integer.class,int.class);                    
            getGetter("setMouthX");
            getSetterNoThrow("setMouthX",Integer.class,int.class);                    
            getGetter("setMouthY");
            getSetterNoThrow("setMouthY",Integer.class,int.class);                    
            getGetter("setNoseX");
            getSetterNoThrow("setNoseX",Integer.class,int.class);                    
            getGetter("setNoseY");
            getSetterNoThrow("setNoseY",Integer.class,int.class);                    
            getGetter("setAngleYaw");
            getSetterNoThrow("setAngleYaw",Integer.class,int.class);                    
            getGetter("setAnglePitch");
            getSetterNoThrow("setAnglePitch",Integer.class,int.class);                    
            getGetter("setAngleRoll");
            getSetterNoThrow("setAngleRoll",Integer.class,int.class);                    
            getGetter("setExtInfo");
            getSetterNoThrow("setExtInfo",java.nio.ByteBuffer.class,byte[].class);                    
            getGetter("setFeatureMd5");
            getSetterNoThrow("setFeatureMd5",String.class); 
            getGetter("setCreateTime");
            getSetterNoThrow("setCreateTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(FaceBean left, R_FACE right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_FACE_ID_ID_MASK;

                }
                if( bitCheck("imageMd5",initialized) && (null != (getterMethod = methods.get("getImageMd5")))){
                    left.setImageMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("imageMd5",modified))
                        selfModified |= FL_FACE_ID_IMAGE_MD5_MASK;

                }
                if( bitCheck("faceLeft",initialized) && (null != (getterMethod = methods.get("getFaceLeft")))){
                    left.setFaceLeft(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("faceLeft",modified))
                        selfModified |= FL_FACE_ID_FACE_LEFT_MASK;

                }
                if( bitCheck("faceTop",initialized) && (null != (getterMethod = methods.get("getFaceTop")))){
                    left.setFaceTop(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("faceTop",modified))
                        selfModified |= FL_FACE_ID_FACE_TOP_MASK;

                }
                if( bitCheck("faceWidth",initialized) && (null != (getterMethod = methods.get("getFaceWidth")))){
                    left.setFaceWidth(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("faceWidth",modified))
                        selfModified |= FL_FACE_ID_FACE_WIDTH_MASK;

                }
                if( bitCheck("faceHeight",initialized) && (null != (getterMethod = methods.get("getFaceHeight")))){
                    left.setFaceHeight(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("faceHeight",modified))
                        selfModified |= FL_FACE_ID_FACE_HEIGHT_MASK;

                }
                if( bitCheck("eyeLeftx",initialized) && (null != (getterMethod = methods.get("getEyeLeftx")))){
                    left.setEyeLeftx(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("eyeLeftx",modified))
                        selfModified |= FL_FACE_ID_EYE_LEFTX_MASK;

                }
                if( bitCheck("eyeLefty",initialized) && (null != (getterMethod = methods.get("getEyeLefty")))){
                    left.setEyeLefty(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("eyeLefty",modified))
                        selfModified |= FL_FACE_ID_EYE_LEFTY_MASK;

                }
                if( bitCheck("eyeRightx",initialized) && (null != (getterMethod = methods.get("getEyeRightx")))){
                    left.setEyeRightx(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("eyeRightx",modified))
                        selfModified |= FL_FACE_ID_EYE_RIGHTX_MASK;

                }
                if( bitCheck("eyeRighty",initialized) && (null != (getterMethod = methods.get("getEyeRighty")))){
                    left.setEyeRighty(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("eyeRighty",modified))
                        selfModified |= FL_FACE_ID_EYE_RIGHTY_MASK;

                }
                if( bitCheck("mouthX",initialized) && (null != (getterMethod = methods.get("getMouthX")))){
                    left.setMouthX(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("mouthX",modified))
                        selfModified |= FL_FACE_ID_MOUTH_X_MASK;

                }
                if( bitCheck("mouthY",initialized) && (null != (getterMethod = methods.get("getMouthY")))){
                    left.setMouthY(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("mouthY",modified))
                        selfModified |= FL_FACE_ID_MOUTH_Y_MASK;

                }
                if( bitCheck("noseX",initialized) && (null != (getterMethod = methods.get("getNoseX")))){
                    left.setNoseX(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("noseX",modified))
                        selfModified |= FL_FACE_ID_NOSE_X_MASK;

                }
                if( bitCheck("noseY",initialized) && (null != (getterMethod = methods.get("getNoseY")))){
                    left.setNoseY(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("noseY",modified))
                        selfModified |= FL_FACE_ID_NOSE_Y_MASK;

                }
                if( bitCheck("angleYaw",initialized) && (null != (getterMethod = methods.get("getAngleYaw")))){
                    left.setAngleYaw(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("angleYaw",modified))
                        selfModified |= FL_FACE_ID_ANGLE_YAW_MASK;

                }
                if( bitCheck("anglePitch",initialized) && (null != (getterMethod = methods.get("getAnglePitch")))){
                    left.setAnglePitch(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("anglePitch",modified))
                        selfModified |= FL_FACE_ID_ANGLE_PITCH_MASK;

                }
                if( bitCheck("angleRoll",initialized) && (null != (getterMethod = methods.get("getAngleRoll")))){
                    left.setAngleRoll(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("angleRoll",modified))
                        selfModified |= FL_FACE_ID_ANGLE_ROLL_MASK;

                }
                if( bitCheck("extInfo",initialized) && (null != (getterMethod = methods.get("getExtInfo")))){
                    left.setExtInfo(cast(java.nio.ByteBuffer.class,getterMethod.invoke(right)));
                    if(bitCheck("extInfo",modified))
                        selfModified |= FL_FACE_ID_EXT_INFO_MASK;

                }
                if( bitCheck("featureMd5",initialized) && (null != (getterMethod = methods.get("getFeatureMd5")))){
                    left.setFeatureMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("featureMd5",modified))
                        selfModified |= FL_FACE_ID_FEATURE_MD5_MASK;

                }
                if( bitCheck("createTime",initialized) && (null != (getterMethod = methods.get("getCreateTime")))){
                    left.setCreateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("createTime",modified))
                        selfModified |= FL_FACE_ID_CREATE_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(FaceBean left, R_FACE right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setImageMd5")) && left.checkImageMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setImageMd5"),left.getImageMd5()));
                        bitOR("imageMd5",initialized);
                        if(left.checkImageMd5Modified())
                            bitOR("imageMd5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFaceLeft")) && left.checkFaceLeftInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFaceLeft"),left.getFaceLeft()));
                        bitOR("faceLeft",initialized);
                        if(left.checkFaceLeftModified())
                            bitOR("faceLeft",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFaceTop")) && left.checkFaceTopInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFaceTop"),left.getFaceTop()));
                        bitOR("faceTop",initialized);
                        if(left.checkFaceTopModified())
                            bitOR("faceTop",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFaceWidth")) && left.checkFaceWidthInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFaceWidth"),left.getFaceWidth()));
                        bitOR("faceWidth",initialized);
                        if(left.checkFaceWidthModified())
                            bitOR("faceWidth",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFaceHeight")) && left.checkFaceHeightInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFaceHeight"),left.getFaceHeight()));
                        bitOR("faceHeight",initialized);
                        if(left.checkFaceHeightModified())
                            bitOR("faceHeight",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setEyeLeftx")) && left.checkEyeLeftxInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setEyeLeftx"),left.getEyeLeftx()));
                        bitOR("eyeLeftx",initialized);
                        if(left.checkEyeLeftxModified())
                            bitOR("eyeLeftx",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setEyeLefty")) && left.checkEyeLeftyInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setEyeLefty"),left.getEyeLefty()));
                        bitOR("eyeLefty",initialized);
                        if(left.checkEyeLeftyModified())
                            bitOR("eyeLefty",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setEyeRightx")) && left.checkEyeRightxInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setEyeRightx"),left.getEyeRightx()));
                        bitOR("eyeRightx",initialized);
                        if(left.checkEyeRightxModified())
                            bitOR("eyeRightx",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setEyeRighty")) && left.checkEyeRightyInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setEyeRighty"),left.getEyeRighty()));
                        bitOR("eyeRighty",initialized);
                        if(left.checkEyeRightyModified())
                            bitOR("eyeRighty",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setMouthX")) && left.checkMouthXInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setMouthX"),left.getMouthX()));
                        bitOR("mouthX",initialized);
                        if(left.checkMouthXModified())
                            bitOR("mouthX",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setMouthY")) && left.checkMouthYInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setMouthY"),left.getMouthY()));
                        bitOR("mouthY",initialized);
                        if(left.checkMouthYModified())
                            bitOR("mouthY",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setNoseX")) && left.checkNoseXInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setNoseX"),left.getNoseX()));
                        bitOR("noseX",initialized);
                        if(left.checkNoseXModified())
                            bitOR("noseX",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setNoseY")) && left.checkNoseYInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setNoseY"),left.getNoseY()));
                        bitOR("noseY",initialized);
                        if(left.checkNoseYModified())
                            bitOR("noseY",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setAngleYaw")) && left.checkAngleYawInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setAngleYaw"),left.getAngleYaw()));
                        bitOR("angleYaw",initialized);
                        if(left.checkAngleYawModified())
                            bitOR("angleYaw",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setAnglePitch")) && left.checkAnglePitchInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setAnglePitch"),left.getAnglePitch()));
                        bitOR("anglePitch",initialized);
                        if(left.checkAnglePitchModified())
                            bitOR("anglePitch",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setAngleRoll")) && left.checkAngleRollInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setAngleRoll"),left.getAngleRoll()));
                        bitOR("angleRoll",initialized);
                        if(left.checkAngleRollModified())
                            bitOR("angleRoll",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setExtInfo")) && left.checkExtInfoInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setExtInfo"),left.getExtInfo()));
                        bitOR("extInfo",initialized);
                        if(left.checkExtInfoModified())
                            bitOR("extInfo",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFeatureMd5")) && left.checkFeatureMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFeatureMd5"),left.getFeatureMd5()));
                        bitOR("featureMd5",initialized);
                        if(left.checkFeatureMd5Modified())
                            bitOR("featureMd5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
// IGNORE field fl_face.create_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setCreateTime")) && left.checkCreateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setCreateTime"),left.getCreateTime()));
                        bitOR("createTime",initialized);
                        if(left.checkCreateTimeModified())
                            bitOR("createTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link FeatureBean} and R_FEATURE <br>
     * @author guyadong
     * @param <R_FEATURE> right type
     *
     */
    public static class FeatureBeanConverter<R_FEATURE> extends IBeanConverter.AbstractHandle<FeatureBean,R_FEATURE>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new FeatureBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_FEATURE,<br>
         *                   if null or empty, use default string:{@link Constant#FL_FEATURE_JAVA_FIELDS}
         */
        public FeatureBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #FeatureBeanConverter(String) */
        public FeatureBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #FeatureBeanConverter(String)}
         */
        public FeatureBeanConverter (Class<FeatureBean> leftClass, Class<R_FEATURE> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #FeatureBeanConverter(Class,Class,String) */
        public FeatureBeanConverter (Class<FeatureBean> leftClass, Class<R_FEATURE> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_FEATURE_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setMd5");
            getSetterNoThrow("setMd5",String.class); 
            getGetter("setPersonId");
            getSetterNoThrow("setPersonId",Integer.class,int.class);                    
            getGetter("setFeature");
            getSetterNoThrow("setFeature",java.nio.ByteBuffer.class,byte[].class);                    
            getGetter("setUpdateTime");
            getSetterNoThrow("setUpdateTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(FeatureBean left, R_FEATURE right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("md5",initialized) && (null != (getterMethod = methods.get("getMd5")))){
                    left.setMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("md5",modified))
                        selfModified |= FL_FEATURE_ID_MD5_MASK;

                }
                if( bitCheck("personId",initialized) && (null != (getterMethod = methods.get("getPersonId")))){
                    left.setPersonId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("personId",modified))
                        selfModified |= FL_FEATURE_ID_PERSON_ID_MASK;

                }
                if( bitCheck("feature",initialized) && (null != (getterMethod = methods.get("getFeature")))){
                    left.setFeature(cast(java.nio.ByteBuffer.class,getterMethod.invoke(right)));
                    if(bitCheck("feature",modified))
                        selfModified |= FL_FEATURE_ID_FEATURE_MASK;

                }
                if( bitCheck("updateTime",initialized) && (null != (getterMethod = methods.get("getUpdateTime")))){
                    left.setUpdateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("updateTime",modified))
                        selfModified |= FL_FEATURE_ID_UPDATE_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(FeatureBean left, R_FEATURE right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setMd5")) && left.checkMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setMd5"),left.getMd5()));
                        bitOR("md5",initialized);
                        if(left.checkMd5Modified())
                            bitOR("md5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPersonId")) && left.checkPersonIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPersonId"),left.getPersonId()));
                        bitOR("personId",initialized);
                        if(left.checkPersonIdModified())
                            bitOR("personId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFeature")) && left.checkFeatureInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFeature"),left.getFeature()));
                        bitOR("feature",initialized);
                        if(left.checkFeatureModified())
                            bitOR("feature",modified);
                    }catch(NullCastPrimitiveException e){}
                }
// IGNORE field fl_feature.update_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setUpdateTime")) && left.checkUpdateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setUpdateTime"),left.getUpdateTime()));
                        bitOR("updateTime",initialized);
                        if(left.checkUpdateTimeModified())
                            bitOR("updateTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link ImageBean} and R_IMAGE <br>
     * @author guyadong
     * @param <R_IMAGE> right type
     *
     */
    public static class ImageBeanConverter<R_IMAGE> extends IBeanConverter.AbstractHandle<ImageBean,R_IMAGE>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new ImageBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_IMAGE,<br>
         *                   if null or empty, use default string:{@link Constant#FL_IMAGE_JAVA_FIELDS}
         */
        public ImageBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #ImageBeanConverter(String) */
        public ImageBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #ImageBeanConverter(String)}
         */
        public ImageBeanConverter (Class<ImageBean> leftClass, Class<R_IMAGE> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #ImageBeanConverter(Class,Class,String) */
        public ImageBeanConverter (Class<ImageBean> leftClass, Class<R_IMAGE> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_IMAGE_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setMd5");
            getSetterNoThrow("setMd5",String.class); 
            getGetter("setFormat");
            getSetterNoThrow("setFormat",String.class); 
            getGetter("setWidth");
            getSetterNoThrow("setWidth",Integer.class,int.class);                    
            getGetter("setHeight");
            getSetterNoThrow("setHeight",Integer.class,int.class);                    
            getGetter("setDepth");
            getSetterNoThrow("setDepth",Integer.class,int.class);                    
            getGetter("setFaceNum");
            getSetterNoThrow("setFaceNum",Integer.class,int.class);                    
            getGetter("setThumbMd5");
            getSetterNoThrow("setThumbMd5",String.class); 
            getGetter("setDeviceId");
            getSetterNoThrow("setDeviceId",Integer.class,int.class);                    
        }
        @Override
        protected void _fromRight(ImageBean left, R_IMAGE right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("md5",initialized) && (null != (getterMethod = methods.get("getMd5")))){
                    left.setMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("md5",modified))
                        selfModified |= FL_IMAGE_ID_MD5_MASK;

                }
                if( bitCheck("format",initialized) && (null != (getterMethod = methods.get("getFormat")))){
                    left.setFormat(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("format",modified))
                        selfModified |= FL_IMAGE_ID_FORMAT_MASK;

                }
                if( bitCheck("width",initialized) && (null != (getterMethod = methods.get("getWidth")))){
                    left.setWidth(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("width",modified))
                        selfModified |= FL_IMAGE_ID_WIDTH_MASK;

                }
                if( bitCheck("height",initialized) && (null != (getterMethod = methods.get("getHeight")))){
                    left.setHeight(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("height",modified))
                        selfModified |= FL_IMAGE_ID_HEIGHT_MASK;

                }
                if( bitCheck("depth",initialized) && (null != (getterMethod = methods.get("getDepth")))){
                    left.setDepth(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("depth",modified))
                        selfModified |= FL_IMAGE_ID_DEPTH_MASK;

                }
                if( bitCheck("faceNum",initialized) && (null != (getterMethod = methods.get("getFaceNum")))){
                    left.setFaceNum(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("faceNum",modified))
                        selfModified |= FL_IMAGE_ID_FACE_NUM_MASK;

                }
                if( bitCheck("thumbMd5",initialized) && (null != (getterMethod = methods.get("getThumbMd5")))){
                    left.setThumbMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("thumbMd5",modified))
                        selfModified |= FL_IMAGE_ID_THUMB_MD5_MASK;

                }
                if( bitCheck("deviceId",initialized) && (null != (getterMethod = methods.get("getDeviceId")))){
                    left.setDeviceId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("deviceId",modified))
                        selfModified |= FL_IMAGE_ID_DEVICE_ID_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(ImageBean left, R_IMAGE right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setMd5")) && left.checkMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setMd5"),left.getMd5()));
                        bitOR("md5",initialized);
                        if(left.checkMd5Modified())
                            bitOR("md5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFormat")) && left.checkFormatInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFormat"),left.getFormat()));
                        bitOR("format",initialized);
                        if(left.checkFormatModified())
                            bitOR("format",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setWidth")) && left.checkWidthInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setWidth"),left.getWidth()));
                        bitOR("width",initialized);
                        if(left.checkWidthModified())
                            bitOR("width",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setHeight")) && left.checkHeightInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setHeight"),left.getHeight()));
                        bitOR("height",initialized);
                        if(left.checkHeightModified())
                            bitOR("height",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setDepth")) && left.checkDepthInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setDepth"),left.getDepth()));
                        bitOR("depth",initialized);
                        if(left.checkDepthModified())
                            bitOR("depth",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setFaceNum")) && left.checkFaceNumInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setFaceNum"),left.getFaceNum()));
                        bitOR("faceNum",initialized);
                        if(left.checkFaceNumModified())
                            bitOR("faceNum",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setThumbMd5")) && left.checkThumbMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setThumbMd5"),left.getThumbMd5()));
                        bitOR("thumbMd5",initialized);
                        if(left.checkThumbMd5Modified())
                            bitOR("thumbMd5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setDeviceId")) && left.checkDeviceIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setDeviceId"),left.getDeviceId()));
                        bitOR("deviceId",initialized);
                        if(left.checkDeviceIdModified())
                            bitOR("deviceId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link LogBean} and R_LOG <br>
     * @author guyadong
     * @param <R_LOG> right type
     *
     */
    public static class LogBeanConverter<R_LOG> extends IBeanConverter.AbstractHandle<LogBean,R_LOG>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new LogBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_LOG,<br>
         *                   if null or empty, use default string:{@link Constant#FL_LOG_JAVA_FIELDS}
         */
        public LogBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #LogBeanConverter(String) */
        public LogBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #LogBeanConverter(String)}
         */
        public LogBeanConverter (Class<LogBean> leftClass, Class<R_LOG> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #LogBeanConverter(Class,Class,String) */
        public LogBeanConverter (Class<LogBean> leftClass, Class<R_LOG> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_LOG_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setPersonId");
            getSetterNoThrow("setPersonId",Integer.class,int.class);                    
            getGetter("setDeviceId");
            getSetterNoThrow("setDeviceId",Integer.class,int.class);                    
            getGetter("setVerifyFeature");
            getSetterNoThrow("setVerifyFeature",String.class); 
            getGetter("setCompareFace");
            getSetterNoThrow("setCompareFace",Integer.class,int.class);                    
            getGetter("setSimilarty");
            getSetterNoThrow("setSimilarty",Double.class,double.class);                    
            getGetter("setVerifyTime");
            getSetterNoThrow("setVerifyTime",java.util.Date.class,Long.class,long.class);  
            getGetter("setCreateTime");
            getSetterNoThrow("setCreateTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(LogBean left, R_LOG right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_LOG_ID_ID_MASK;

                }
                if( bitCheck("personId",initialized) && (null != (getterMethod = methods.get("getPersonId")))){
                    left.setPersonId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("personId",modified))
                        selfModified |= FL_LOG_ID_PERSON_ID_MASK;

                }
                if( bitCheck("deviceId",initialized) && (null != (getterMethod = methods.get("getDeviceId")))){
                    left.setDeviceId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("deviceId",modified))
                        selfModified |= FL_LOG_ID_DEVICE_ID_MASK;

                }
                if( bitCheck("verifyFeature",initialized) && (null != (getterMethod = methods.get("getVerifyFeature")))){
                    left.setVerifyFeature(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("verifyFeature",modified))
                        selfModified |= FL_LOG_ID_VERIFY_FEATURE_MASK;

                }
                if( bitCheck("compareFace",initialized) && (null != (getterMethod = methods.get("getCompareFace")))){
                    left.setCompareFace(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("compareFace",modified))
                        selfModified |= FL_LOG_ID_COMPARE_FACE_MASK;

                }
                if( bitCheck("similarty",initialized) && (null != (getterMethod = methods.get("getSimilarty")))){
                    left.setSimilarty(cast(Double.class,getterMethod.invoke(right)));
                    if(bitCheck("similarty",modified))
                        selfModified |= FL_LOG_ID_SIMILARTY_MASK;

                }
                if( bitCheck("verifyTime",initialized) && (null != (getterMethod = methods.get("getVerifyTime")))){
                    left.setVerifyTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("verifyTime",modified))
                        selfModified |= FL_LOG_ID_VERIFY_TIME_MASK;

                }
                if( bitCheck("createTime",initialized) && (null != (getterMethod = methods.get("getCreateTime")))){
                    left.setCreateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("createTime",modified))
                        selfModified |= FL_LOG_ID_CREATE_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(LogBean left, R_LOG right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPersonId")) && left.checkPersonIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPersonId"),left.getPersonId()));
                        bitOR("personId",initialized);
                        if(left.checkPersonIdModified())
                            bitOR("personId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setDeviceId")) && left.checkDeviceIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setDeviceId"),left.getDeviceId()));
                        bitOR("deviceId",initialized);
                        if(left.checkDeviceIdModified())
                            bitOR("deviceId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setVerifyFeature")) && left.checkVerifyFeatureInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setVerifyFeature"),left.getVerifyFeature()));
                        bitOR("verifyFeature",initialized);
                        if(left.checkVerifyFeatureModified())
                            bitOR("verifyFeature",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setCompareFace")) && left.checkCompareFaceInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setCompareFace"),left.getCompareFace()));
                        bitOR("compareFace",initialized);
                        if(left.checkCompareFaceModified())
                            bitOR("compareFace",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setSimilarty")) && left.checkSimilartyInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setSimilarty"),left.getSimilarty()));
                        bitOR("similarty",initialized);
                        if(left.checkSimilartyModified())
                            bitOR("similarty",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setVerifyTime")) && left.checkVerifyTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setVerifyTime"),left.getVerifyTime()));
                        bitOR("verifyTime",initialized);
                        if(left.checkVerifyTimeModified())
                            bitOR("verifyTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
// IGNORE field fl_log.create_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setCreateTime")) && left.checkCreateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setCreateTime"),left.getCreateTime()));
                        bitOR("createTime",initialized);
                        if(left.checkCreateTimeModified())
                            bitOR("createTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link PermitBean} and R_PERMIT <br>
     * @author guyadong
     * @param <R_PERMIT> right type
     *
     */
    public static class PermitBeanConverter<R_PERMIT> extends IBeanConverter.AbstractHandle<PermitBean,R_PERMIT>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new PermitBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_PERMIT,<br>
         *                   if null or empty, use default string:{@link Constant#FL_PERMIT_JAVA_FIELDS}
         */
        public PermitBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #PermitBeanConverter(String) */
        public PermitBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #PermitBeanConverter(String)}
         */
        public PermitBeanConverter (Class<PermitBean> leftClass, Class<R_PERMIT> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #PermitBeanConverter(Class,Class,String) */
        public PermitBeanConverter (Class<PermitBean> leftClass, Class<R_PERMIT> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_PERMIT_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setDeviceGroupId");
            getSetterNoThrow("setDeviceGroupId",Integer.class,int.class);                    
            getGetter("setPersonGroupId");
            getSetterNoThrow("setPersonGroupId",Integer.class,int.class);                    
            getGetter("setCreateTime");
            getSetterNoThrow("setCreateTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(PermitBean left, R_PERMIT right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("deviceGroupId",initialized) && (null != (getterMethod = methods.get("getDeviceGroupId")))){
                    left.setDeviceGroupId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("deviceGroupId",modified))
                        selfModified |= FL_PERMIT_ID_DEVICE_GROUP_ID_MASK;

                }
                if( bitCheck("personGroupId",initialized) && (null != (getterMethod = methods.get("getPersonGroupId")))){
                    left.setPersonGroupId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("personGroupId",modified))
                        selfModified |= FL_PERMIT_ID_PERSON_GROUP_ID_MASK;

                }
                if( bitCheck("createTime",initialized) && (null != (getterMethod = methods.get("getCreateTime")))){
                    left.setCreateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("createTime",modified))
                        selfModified |= FL_PERMIT_ID_CREATE_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(PermitBean left, R_PERMIT right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setDeviceGroupId")) && left.checkDeviceGroupIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setDeviceGroupId"),left.getDeviceGroupId()));
                        bitOR("deviceGroupId",initialized);
                        if(left.checkDeviceGroupIdModified())
                            bitOR("deviceGroupId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPersonGroupId")) && left.checkPersonGroupIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPersonGroupId"),left.getPersonGroupId()));
                        bitOR("personGroupId",initialized);
                        if(left.checkPersonGroupIdModified())
                            bitOR("personGroupId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
// IGNORE field fl_permit.create_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setCreateTime")) && left.checkCreateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setCreateTime"),left.getCreateTime()));
                        bitOR("createTime",initialized);
                        if(left.checkCreateTimeModified())
                            bitOR("createTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link PersonBean} and R_PERSON <br>
     * @author guyadong
     * @param <R_PERSON> right type
     *
     */
    public static class PersonBeanConverter<R_PERSON> extends IBeanConverter.AbstractHandle<PersonBean,R_PERSON>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new PersonBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_PERSON,<br>
         *                   if null or empty, use default string:{@link Constant#FL_PERSON_JAVA_FIELDS}
         */
        public PersonBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #PersonBeanConverter(String) */
        public PersonBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #PersonBeanConverter(String)}
         */
        public PersonBeanConverter (Class<PersonBean> leftClass, Class<R_PERSON> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #PersonBeanConverter(Class,Class,String) */
        public PersonBeanConverter (Class<PersonBean> leftClass, Class<R_PERSON> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_PERSON_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setGroupId");
            getSetterNoThrow("setGroupId",Integer.class,int.class);                    
            getGetter("setName");
            getSetterNoThrow("setName",String.class); 
            getGetter("setSex");
            getSetterNoThrow("setSex",Integer.class,int.class);                    
            getGetter("setBirthdate");
            getSetterNoThrow("setBirthdate",java.util.Date.class,Long.class,long.class);  
            getGetter("setPapersType");
            getSetterNoThrow("setPapersType",Integer.class,int.class);                    
            getGetter("setPapersNum");
            getSetterNoThrow("setPapersNum",String.class); 
            getGetter("setImageMd5");
            getSetterNoThrow("setImageMd5",String.class); 
            getGetter("setExpiryDate");
            getSetterNoThrow("setExpiryDate",java.util.Date.class,Long.class,long.class);  
            getGetter("setCreateTime");
            getSetterNoThrow("setCreateTime",java.util.Date.class,Long.class,long.class);  
            getGetter("setUpdateTime");
            getSetterNoThrow("setUpdateTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(PersonBean left, R_PERSON right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_PERSON_ID_ID_MASK;

                }
                if( bitCheck("groupId",initialized) && (null != (getterMethod = methods.get("getGroupId")))){
                    left.setGroupId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("groupId",modified))
                        selfModified |= FL_PERSON_ID_GROUP_ID_MASK;

                }
                if( bitCheck("name",initialized) && (null != (getterMethod = methods.get("getName")))){
                    left.setName(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("name",modified))
                        selfModified |= FL_PERSON_ID_NAME_MASK;

                }
                if( bitCheck("sex",initialized) && (null != (getterMethod = methods.get("getSex")))){
                    left.setSex(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("sex",modified))
                        selfModified |= FL_PERSON_ID_SEX_MASK;

                }
                if( bitCheck("birthdate",initialized) && (null != (getterMethod = methods.get("getBirthdate")))){
                    left.setBirthdate(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("birthdate",modified))
                        selfModified |= FL_PERSON_ID_BIRTHDATE_MASK;

                }
                if( bitCheck("papersType",initialized) && (null != (getterMethod = methods.get("getPapersType")))){
                    left.setPapersType(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("papersType",modified))
                        selfModified |= FL_PERSON_ID_PAPERS_TYPE_MASK;

                }
                if( bitCheck("papersNum",initialized) && (null != (getterMethod = methods.get("getPapersNum")))){
                    left.setPapersNum(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("papersNum",modified))
                        selfModified |= FL_PERSON_ID_PAPERS_NUM_MASK;

                }
                if( bitCheck("imageMd5",initialized) && (null != (getterMethod = methods.get("getImageMd5")))){
                    left.setImageMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("imageMd5",modified))
                        selfModified |= FL_PERSON_ID_IMAGE_MD5_MASK;

                }
                if( bitCheck("expiryDate",initialized) && (null != (getterMethod = methods.get("getExpiryDate")))){
                    left.setExpiryDate(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("expiryDate",modified))
                        selfModified |= FL_PERSON_ID_EXPIRY_DATE_MASK;

                }
                if( bitCheck("createTime",initialized) && (null != (getterMethod = methods.get("getCreateTime")))){
                    left.setCreateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("createTime",modified))
                        selfModified |= FL_PERSON_ID_CREATE_TIME_MASK;

                }
                if( bitCheck("updateTime",initialized) && (null != (getterMethod = methods.get("getUpdateTime")))){
                    left.setUpdateTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("updateTime",modified))
                        selfModified |= FL_PERSON_ID_UPDATE_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(PersonBean left, R_PERSON right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setGroupId")) && left.checkGroupIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setGroupId"),left.getGroupId()));
                        bitOR("groupId",initialized);
                        if(left.checkGroupIdModified())
                            bitOR("groupId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setName")) && left.checkNameInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setName"),left.getName()));
                        bitOR("name",initialized);
                        if(left.checkNameModified())
                            bitOR("name",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setSex")) && left.checkSexInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setSex"),left.getSex()));
                        bitOR("sex",initialized);
                        if(left.checkSexModified())
                            bitOR("sex",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setBirthdate")) && left.checkBirthdateInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setBirthdate"),left.getBirthdate()));
                        bitOR("birthdate",initialized);
                        if(left.checkBirthdateModified())
                            bitOR("birthdate",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPapersType")) && left.checkPapersTypeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPapersType"),left.getPapersType()));
                        bitOR("papersType",initialized);
                        if(left.checkPapersTypeModified())
                            bitOR("papersType",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPapersNum")) && left.checkPapersNumInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPapersNum"),left.getPapersNum()));
                        bitOR("papersNum",initialized);
                        if(left.checkPapersNumModified())
                            bitOR("papersNum",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setImageMd5")) && left.checkImageMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setImageMd5"),left.getImageMd5()));
                        bitOR("imageMd5",initialized);
                        if(left.checkImageMd5Modified())
                            bitOR("imageMd5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setExpiryDate")) && left.checkExpiryDateInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setExpiryDate"),left.getExpiryDate()));
                        bitOR("expiryDate",initialized);
                        if(left.checkExpiryDateModified())
                            bitOR("expiryDate",modified);
                    }catch(NullCastPrimitiveException e){}
                }
// IGNORE field fl_person.create_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setCreateTime")) && left.checkCreateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setCreateTime"),left.getCreateTime()));
                        bitOR("createTime",initialized);
                        if(left.checkCreateTimeModified())
                            bitOR("createTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
// IGNORE field fl_person.update_time , controlled by 'general.beanconverter.tonative.ignore' in properties file
/*
                if(null != (setterMethod = methods.get("setUpdateTime")) && left.checkUpdateTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setUpdateTime"),left.getUpdateTime()));
                        bitOR("updateTime",initialized);
                        if(left.checkUpdateTimeModified())
                            bitOR("updateTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
*/
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link PersonGroupBean} and R_PERSONGROUP <br>
     * @author guyadong
     * @param <R_PERSONGROUP> right type
     *
     */
    public static class PersonGroupBeanConverter<R_PERSONGROUP> extends IBeanConverter.AbstractHandle<PersonGroupBean,R_PERSONGROUP>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new PersonGroupBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_PERSONGROUP,<br>
         *                   if null or empty, use default string:{@link Constant#FL_PERSON_GROUP_JAVA_FIELDS}
         */
        public PersonGroupBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #PersonGroupBeanConverter(String) */
        public PersonGroupBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #PersonGroupBeanConverter(String)}
         */
        public PersonGroupBeanConverter (Class<PersonGroupBean> leftClass, Class<R_PERSONGROUP> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #PersonGroupBeanConverter(Class,Class,String) */
        public PersonGroupBeanConverter (Class<PersonGroupBean> leftClass, Class<R_PERSONGROUP> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_PERSON_GROUP_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setName");
            getSetterNoThrow("setName",String.class); 
            getGetter("setLeaf");
            getSetterNoThrow("setLeaf",Integer.class,int.class);                    
            getGetter("setParent");
            getSetterNoThrow("setParent",Integer.class,int.class);                    
        }
        @Override
        protected void _fromRight(PersonGroupBean left, R_PERSONGROUP right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_PERSON_GROUP_ID_ID_MASK;

                }
                if( bitCheck("name",initialized) && (null != (getterMethod = methods.get("getName")))){
                    left.setName(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("name",modified))
                        selfModified |= FL_PERSON_GROUP_ID_NAME_MASK;

                }
                if( bitCheck("leaf",initialized) && (null != (getterMethod = methods.get("getLeaf")))){
                    left.setLeaf(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("leaf",modified))
                        selfModified |= FL_PERSON_GROUP_ID_LEAF_MASK;

                }
                if( bitCheck("parent",initialized) && (null != (getterMethod = methods.get("getParent")))){
                    left.setParent(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("parent",modified))
                        selfModified |= FL_PERSON_GROUP_ID_PARENT_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(PersonGroupBean left, R_PERSONGROUP right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setName")) && left.checkNameInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setName"),left.getName()));
                        bitOR("name",initialized);
                        if(left.checkNameModified())
                            bitOR("name",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setLeaf")) && left.checkLeafInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setLeaf"),left.getLeaf()));
                        bitOR("leaf",initialized);
                        if(left.checkLeafModified())
                            bitOR("leaf",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setParent")) && left.checkParentInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setParent"),left.getParent()));
                        bitOR("parent",initialized);
                        if(left.checkParentModified())
                            bitOR("parent",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link StoreBean} and R_STORE <br>
     * @author guyadong
     * @param <R_STORE> right type
     *
     */
    public static class StoreBeanConverter<R_STORE> extends IBeanConverter.AbstractHandle<StoreBean,R_STORE>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new StoreBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_STORE,<br>
         *                   if null or empty, use default string:{@link Constant#FL_STORE_JAVA_FIELDS}
         */
        public StoreBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #StoreBeanConverter(String) */
        public StoreBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #StoreBeanConverter(String)}
         */
        public StoreBeanConverter (Class<StoreBean> leftClass, Class<R_STORE> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #StoreBeanConverter(Class,Class,String) */
        public StoreBeanConverter (Class<StoreBean> leftClass, Class<R_STORE> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_STORE_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setMd5");
            getSetterNoThrow("setMd5",String.class); 
            getGetter("setEncoding");
            getSetterNoThrow("setEncoding",String.class); 
            getGetter("setData");
            getSetterNoThrow("setData",java.nio.ByteBuffer.class,byte[].class);                    
        }
        @Override
        protected void _fromRight(StoreBean left, R_STORE right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("md5",initialized) && (null != (getterMethod = methods.get("getMd5")))){
                    left.setMd5(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("md5",modified))
                        selfModified |= FL_STORE_ID_MD5_MASK;

                }
                if( bitCheck("encoding",initialized) && (null != (getterMethod = methods.get("getEncoding")))){
                    left.setEncoding(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("encoding",modified))
                        selfModified |= FL_STORE_ID_ENCODING_MASK;

                }
                if( bitCheck("data",initialized) && (null != (getterMethod = methods.get("getData")))){
                    left.setData(cast(java.nio.ByteBuffer.class,getterMethod.invoke(right)));
                    if(bitCheck("data",modified))
                        selfModified |= FL_STORE_ID_DATA_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(StoreBean left, R_STORE right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setMd5")) && left.checkMd5Initialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setMd5"),left.getMd5()));
                        bitOR("md5",initialized);
                        if(left.checkMd5Modified())
                            bitOR("md5",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setEncoding")) && left.checkEncodingInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setEncoding"),left.getEncoding()));
                        bitOR("encoding",initialized);
                        if(left.checkEncodingModified())
                            bitOR("encoding",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setData")) && left.checkDataInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setData"),left.getData()));
                        bitOR("data",initialized);
                        if(left.checkDataModified())
                            bitOR("data",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
    /**
     * implementation of {@link IBeanConverter} by reflect<br>
     * generic type converter between {@link LogLightBean} and R_LOGLIGHT <br>
     * @author guyadong
     * @param <R_LOGLIGHT> right type
     *
     */
    public static class LogLightBeanConverter<R_LOGLIGHT> extends IBeanConverter.AbstractHandle<LogLightBean,R_LOGLIGHT>{
        private final Map<String,Method> methods = new Hashtable<String,Method>();
        private final Map<String,Integer> rightIndexs = new Hashtable<String,Integer>();
        private final Map<String, Class<?>> setterParams = new Hashtable<String,Class<?>>();

        private boolean bitCheck(String name,long...bits){
            Integer id = rightIndexs.get(name);
            return (null == id)?false:BeanConverterUtils.bitCheck(id.intValue(),bits);
        }
        private long[] bitOR(String name,long... bits){
            return BeanConverterUtils.bitOR(rightIndexs.get(name),bits);
        }
        private void getGetter(String name){
            try{
                methods.put(name,rightType.getMethod(name));
            }catch(NoSuchMethodException e){}
        }
        private void getSetter(String name, Class<?>...types) throws NoSuchMethodException{
            for(Class<?>paramType:types){
                try{
                    methods.put(name,rightType.getMethod(name,paramType));
                    setterParams.put(name, paramType);
                    return;
                }catch(NoSuchMethodException e){
                    continue;
                }
            }
            throw new NoSuchMethodException();
        }
        private void getSetterNoThrow(String name, Class<?>...types){
            try{
                getSetter(name,types);
            }catch(NoSuchMethodException e){}
        }
        /** 
         * usage: <pre>new LogLightBeanConverter&lt;Model&gt;(javaFields){};</pre>
         * @param javaFields a comma splice string,including all field name of R_LOGLIGHT,<br>
         *                   if null or empty, use default string:{@link Constant#FL_LOG_LIGHT_JAVA_FIELDS}
         */
        public LogLightBeanConverter(String javaFields){
            super();
            init(javaFields);
        }
        /** @see #LogLightBeanConverter(String) */
        public LogLightBeanConverter(){
            this(null);
        }
        /**
         * constructor
         * @param leftClass
         * @param rightClass
         * @param javaFields see also {@link #LogLightBeanConverter(String)}
         */
        public LogLightBeanConverter (Class<LogLightBean> leftClass, Class<R_LOGLIGHT> rightClass,String javaFields){
            super(leftClass,rightClass);
            init(javaFields);
        }
        /** @see #LogLightBeanConverter(Class,Class,String) */
        public LogLightBeanConverter (Class<LogLightBean> leftClass, Class<R_LOGLIGHT> rightClass){
            this(leftClass,rightClass,null);
        }
        private void init(String javaFields){
            if(null == javaFields || javaFields.isEmpty()){
                javaFields = FL_LOG_LIGHT_JAVA_FIELDS;
            }
            String []rightFields = javaFields.split(",");
            for(int i = 0 ; i < rightFields.length; ++i){
                String field = rightFields[i].trim();
                if(!field.matches("\\w+"))
                    throw new IllegalArgumentException("invalid 'javaFields':" + javaFields);
                rightIndexs.put(field,i);
            }
            try{
                methods.put(IS_NEW,rightType.getMethod(IS_NEW));
                methods.put(GET_INITIALIZED,rightType.getMethod(GET_INITIALIZED));
                getSetter(SET_NEW,boolean.class);
                if(rightIndexs.size() > 64)
                    getSetter(SET_INITIALIZED,long[].class,List.class);
                else
                    getSetter(SET_INITIALIZED,long.class);
                getGetter(GET_MODIFIED);
                if(rightIndexs.size() > 64)
                    getSetter(SET_MODIFIED,long[].class,List.class);
                else
                    getSetter(SET_MODIFIED,long.class);
            }catch(NoSuchMethodException e){
                throw new RuntimeException(e);
            }

            getGetter("setId");
            getSetterNoThrow("setId",Integer.class,int.class);                    
            getGetter("setPersonId");
            getSetterNoThrow("setPersonId",Integer.class,int.class);                    
            getGetter("setName");
            getSetterNoThrow("setName",String.class); 
            getGetter("setPapersType");
            getSetterNoThrow("setPapersType",Integer.class,int.class);                    
            getGetter("setPapersNum");
            getSetterNoThrow("setPapersNum",String.class); 
            getGetter("setVerifyTime");
            getSetterNoThrow("setVerifyTime",java.util.Date.class,Long.class,long.class);  
        }
        @Override
        protected void _fromRight(LogLightBean left, R_LOGLIGHT right) {
            try{
                Method getterMethod;
                left.resetIsModified();
                long selfModified = 0L;
                long[] initialized;
                long[] modified;
                if(rightIndexs.size() > 64){
                    initialized = (long[])methods.get(GET_INITIALIZED).invoke(right);
                    modified = (long[])methods.get(GET_MODIFIED).invoke(right);
                }else{
                    initialized = new long[]{(Long)methods.get(GET_INITIALIZED).invoke(right)};
                    modified = new long[]{(Long)methods.get(GET_MODIFIED).invoke(right)};
                }
                if( bitCheck("id",initialized) && (null != (getterMethod = methods.get("getId")))){
                    left.setId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("id",modified))
                        selfModified |= FL_LOG_LIGHT_ID_ID_MASK;

                }
                if( bitCheck("personId",initialized) && (null != (getterMethod = methods.get("getPersonId")))){
                    left.setPersonId(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("personId",modified))
                        selfModified |= FL_LOG_LIGHT_ID_PERSON_ID_MASK;

                }
                if( bitCheck("name",initialized) && (null != (getterMethod = methods.get("getName")))){
                    left.setName(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("name",modified))
                        selfModified |= FL_LOG_LIGHT_ID_NAME_MASK;

                }
                if( bitCheck("papersType",initialized) && (null != (getterMethod = methods.get("getPapersType")))){
                    left.setPapersType(cast(Integer.class,getterMethod.invoke(right)));
                    if(bitCheck("papersType",modified))
                        selfModified |= FL_LOG_LIGHT_ID_PAPERS_TYPE_MASK;

                }
                if( bitCheck("papersNum",initialized) && (null != (getterMethod = methods.get("getPapersNum")))){
                    left.setPapersNum(cast(String.class,getterMethod.invoke(right)));
                    if(bitCheck("papersNum",modified))
                        selfModified |= FL_LOG_LIGHT_ID_PAPERS_NUM_MASK;

                }
                if( bitCheck("verifyTime",initialized) && (null != (getterMethod = methods.get("getVerifyTime")))){
                    left.setVerifyTime(cast(java.util.Date.class,getterMethod.invoke(right)));
                    if(bitCheck("verifyTime",modified))
                        selfModified |= FL_LOG_LIGHT_ID_VERIFY_TIME_MASK;

                }
                left.isNew((Boolean)methods.get(IS_NEW).invoke(right));
                left.setModified(selfModified);
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }

        @Override
        protected void _toRight(LogLightBean left, R_LOGLIGHT right) {
            try{
                Method setterMethod;
                long[] initialized = new long[(rightIndexs.size() + 63)>>6];
                long[] modified = new long[(rightIndexs.size() + 63)>>6];
                Arrays.fill(initialized, 0L);
                Arrays.fill(modified, 0L);
                if(null != (setterMethod = methods.get("setId")) && left.checkIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setId"),left.getId()));
                        bitOR("id",initialized);
                        if(left.checkIdModified())
                            bitOR("id",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPersonId")) && left.checkPersonIdInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPersonId"),left.getPersonId()));
                        bitOR("personId",initialized);
                        if(left.checkPersonIdModified())
                            bitOR("personId",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setName")) && left.checkNameInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setName"),left.getName()));
                        bitOR("name",initialized);
                        if(left.checkNameModified())
                            bitOR("name",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPapersType")) && left.checkPapersTypeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPapersType"),left.getPapersType()));
                        bitOR("papersType",initialized);
                        if(left.checkPapersTypeModified())
                            bitOR("papersType",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setPapersNum")) && left.checkPapersNumInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setPapersNum"),left.getPapersNum()));
                        bitOR("papersNum",initialized);
                        if(left.checkPapersNumModified())
                            bitOR("papersNum",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get("setVerifyTime")) && left.checkVerifyTimeInitialized()){
                    try{
                        setterMethod.invoke(right,cast(setterParams.get("setVerifyTime"),left.getVerifyTime()));
                        bitOR("verifyTime",initialized);
                        if(left.checkVerifyTimeModified())
                            bitOR("verifyTime",modified);
                    }catch(NullCastPrimitiveException e){}
                }
                if(null != (setterMethod = methods.get(SET_MODIFIED))){
                    if( initialized.length > 1)
                        setterMethod.invoke(right,cast(setterParams.get(SET_MODIFIED),initialized));
                    else
                        setterMethod.invoke(right,initialized[0]);
                }
                methods.get(SET_NEW).invoke(right,left.isNew());
                if( initialized.length > 1){
                    methods.get(SET_INITIALIZED).invoke(right,cast(setterParams.get(SET_INITIALIZED),initialized));
                    methods.get(SET_MODIFIED).invoke(right,cast(setterParams.get(SET_MODIFIED),modified));
                }else{
                    methods.get(SET_INITIALIZED).invoke(right,initialized[0]);
                    methods.get(SET_MODIFIED).invoke(right,modified[0]);
                }
            }catch(RuntimeException e){
                throw e;
            }catch(Exception e){
                throw new RuntimeException(e);
            }
        }
    }; 
}
